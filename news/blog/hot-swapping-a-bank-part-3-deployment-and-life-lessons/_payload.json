[{"data":1,"prerenderedAt":499},["ShallowReactive",2],{"9ccUp031x1":3},{"pageSetup":4,"sections":15},{"title":5,"slug":6,"description":9,"keywords":10,"image":11},"Hot Swapping a Bank Part 3: Deployment and Life Lessons",{"_type":7,"current":8},"slug","hot-swapping-a-bank-part-3-deployment-and-life-lessons","Clear Street is a cloud-native financial technology firm on a mission to modernize the brokerage ecosystem.",null,{"url":12,"width":13,"height":14},"https://cdn.sanity.io/images/40fnhjbe/production/7da6e8af4e87b0bd3fed4b412ae138aba8f4b5bf-3840x2160.png",3840,2160,{"header":16,"content":39,"footer":410},{"title":5,"date":17,"summary":9,"author":18,"category":35,"hello":38},"2022-07-12",{"name":19,"_updatedAt":20,"_createdAt":21,"_rev":22,"photo":23,"role":30,"_type":31,"slug":32,"_id":34},"Clear Street Engineering","2024-05-30T15:04:12Z","2024-02-16T14:38:42Z","oquihqXh9OzAvkinFGpwlk",{"width":24,"height":24,"extension":25,"alt":10,"hotspot":10,"asset":26,"url":29},480,"png",{"_ref":27,"_type":28},"image-f9f54b5f5240dfdb9749b6abea1e0ea4720c0dee-480x480-png","reference","https://cdn.sanity.io/images/40fnhjbe/production/f9f54b5f5240dfdb9749b6abea1e0ea4720c0dee-480x480.png","","authors",{"current":33,"_type":7},"clear-street-engineering","FY3Umrpkptjq2bXyZZikKw",{"name":36,"colorSlug":37},"Engineering","engineering","world",{"legalText":40,"form":83,"type":112,"readingTime":113,"body":114,"references":382,"pressReleasesFootNote":383},[41,75],{"children":42,"_type":66,"style":67,"_key":68,"markDefs":69},[43,48,53,57,62],{"_type":44,"marks":45,"text":46,"_key":47},"span",[],"Clear Street does not provide investment, legal, regulatory, tax, or compliance advice. Consult professionals in these fields to address your specific circumstances. These materials are: (i) solely an overview of Clear Street’s products and services; (ii) provided for informational purposes only; and (iii) subject to change without notice or obligation to replace any information contained therein.\n\nProducts and services are offered by Clear Street LLC as a Broker Dealer member FINRA and SIPC and a Futures Commission Merchant registered with the CFTC and member of NFA. Additional information about Clear Street is available on FINRA ","e217f565c4110",{"_key":49,"_type":44,"marks":50,"text":52},"e217f565c4111",[51],"10659f16c05f","BrokerCheck",{"_type":44,"marks":54,"text":55,"_key":56},[],", including its Customer Relationship Summary and NFA ","e217f565c4112",{"_type":44,"marks":58,"text":60,"_key":61},[59],"3c111ef5e988","BASIC | NFA (futures.org)","e217f565c4113",{"marks":63,"text":64,"_key":65,"_type":44},[],".\n‍\nCopyright © 2024 Clear Street LLC. All rights reserved. Clear Street and the Shield Logo are Registered Trademarks of Clear Street LLC\n","e217f565c4114","block","normal","cd3115128082",[70,73],{"_key":51,"_type":71,"href":72},"link","https://brokercheck.finra.org/firm/summary/288933",{"_type":71,"href":74,"_key":59},"https://www.nfa.futures.org/BasicNet/basic-profile.aspx?nfaid=XCoGScQYyvw%3D",{"children":76,"_type":66,"style":67,"_key":81,"markDefs":82},[77],{"_type":44,"marks":78,"text":79,"_key":80},[],"\n","a19adde9170f0","38805a72b34d",[],{"title":84,"slug":85,"fields":86},"Contact","contact",[87,93,98,103,107],{"errorMessage":88,"_type":89,"name":90,"label":91,"required":92},"Please add your full name","field.string","full-name","Full name",true,{"required":92,"errorMessage":94,"_type":95,"name":96,"label":97},"Invalid email","field.email","work-email","Work email",{"name":99,"label":100,"required":92,"errorMessage":101,"_type":102},"work-phone","Work phone","Please add your work phone","field.phone",{"label":104,"required":92,"errorMessage":105,"_type":89,"name":106},"Company","Please add your company","company",{"required":108,"errorMessage":10,"_type":109,"name":110,"label":111},false,"field.text","message","Message (optional)","blog",6,[115,123,130,160,170,178,185,193,200,208,215,223,230,238,245,263,271,279,293,305,317,329,341,348,356,363],{"_type":66,"style":67,"_key":116,"markDefs":117,"children":118},"5ff1738fb3b0",[],[119],{"_type":44,"marks":120,"text":121,"_key":122},[],"BK is Clear Street’s proprietary transaction processing system, used to process more than $3 billion in daily trading volume. BK is the newer, faster version of our legacy Book Keeping system, Bank. Where Bank had issues with low throughput, data modeling, and messy points of extension, BK is more agile and scalable, to support our growing business.","5ff1738fb3b00",{"_type":66,"style":67,"_key":124,"markDefs":125,"children":126},"826ed121aa3f",[],[127],{"_type":44,"marks":128,"text":30,"_key":129},[],"826ed121aa3f0",{"_type":66,"style":67,"_key":131,"markDefs":132,"children":139},"015b9e1be1a8",[133,136],{"_type":71,"to":134,"_key":135},"https://medium.com/clear-street/hot-swapping-a-bank-part-1-the-problem-and-the-solution-55e7c4cea2f2","ae03c58721c7",{"_type":71,"to":137,"_key":138},"https://medium.com/clear-street/hot-swapping-a-bank-part-2-integration-and-migration-prep-5795c757ab2","ea30a523b519",[140,144,148,152,156],{"_key":141,"_type":44,"marks":142,"text":143},"015b9e1be1a80",[],"In ",{"text":145,"_key":146,"_type":44,"marks":147},"part 1","015b9e1be1a81",[135],{"_key":149,"_type":44,"marks":150,"text":151},"015b9e1be1a82",[]," of this series, I outlined how we identified areas for improvement within Bank and used a data validation system to ensure we were solving those issues when we built BK. In ",{"text":153,"_key":154,"_type":44,"marks":155},"part 2","015b9e1be1a83",[138],{"marks":157,"text":158,"_key":159,"_type":44},[],", I covered how we approached compatibility layers and data migration. After multiple rounds of validating, integrating and migrating, we were finally ready to deploy our new core transaction processing system. In the third and final part of this series, I’ll walk through the final release and the lessons we learned along the way.","015b9e1be1a84",{"_type":66,"style":161,"_key":162,"markDefs":163,"children":164},"h5","c4b086aee33e",[],[165],{"marks":166,"text":168,"_key":169,"_type":44},[167],"strong","It’s Go Time: Deployment Day","c4b086aee33e0",{"markDefs":171,"children":172,"_type":66,"style":67,"_key":177},[],[173],{"_type":44,"marks":174,"text":175,"_key":176},[],"Before deployment day, we fully scripted what needed to happen upon BK’s release and thoroughly documented each step in a single Release Script wiki page. Clear Street’s engineering and operations teams reviewed this document end-to-end and held multiple dry runs in our pre-production environment.","967bb13b4c910","967bb13b4c91",{"_type":66,"style":67,"_key":179,"markDefs":180,"children":181},"50c86af4e466",[],[182],{"_type":44,"marks":183,"text":30,"_key":184},[],"50c86af4e4660",{"markDefs":186,"children":187,"_type":66,"style":67,"_key":192},[],[188],{"_type":44,"marks":189,"text":190,"_key":191},[],"The Release Script included commands that must be run, services that needed to be scaled down, links to code changes that had to be merged at certain points, SQL scripts to verify things like replication lag and resetting of database sequences, and a laundry list of other items to make sure deployment would go off without a hitch.","8c8c3b3b94f90","8c8c3b3b94f9",{"children":194,"_type":66,"style":67,"_key":198,"markDefs":199},[195],{"text":30,"_key":196,"_type":44,"marks":197},"27cf4e4fde220",[],"27cf4e4fde22",[],{"markDefs":201,"children":202,"_type":66,"style":67,"_key":207},[],[203],{"_type":44,"marks":204,"text":205,"_key":206},[],"The script also included a point of no return, when BK would be released and we had to commit to it being live. We triple-checked everything to avoid any last-minute changes. It was critical that by the time we reached the point of no return, we were comfortable that the system was healthy and in its correct state. Specifically, we had to verify that ledgers were matching and that open trades and settlements were sitting in the right places.","8a1d1b74f9100","8a1d1b74f910",{"style":67,"_key":209,"markDefs":210,"children":211,"_type":66},"aced0b703898",[],[212],{"_type":44,"marks":213,"text":30,"_key":214},[],"aced0b7038980",{"_type":66,"style":67,"_key":216,"markDefs":217,"children":218},"39172d06243a",[],[219],{"_type":44,"marks":220,"text":221,"_key":222},[],"I wish I had some screenshots or recordings of the deployment. We had ~20 people on a Google Meet call, sharing their screens and confirming the state before and after executing each step of the script. It felt like we were landing on the Moon! It was a sight to be seen.","39172d06243a0",{"style":67,"_key":224,"markDefs":225,"children":226,"_type":66},"50eb14de43ee",[],[227],{"_type":44,"marks":228,"text":30,"_key":229},[],"50eb14de43ee0",{"children":231,"_type":66,"style":67,"_key":236,"markDefs":237},[232],{"_type":44,"marks":233,"text":234,"_key":235},[],"Releasing software this big, complicated, and intertwined with the whole business is… a big deal, so how did Clear Street get it done? We executed multiple rounds of testing with the different tools described, we worked hand-in-hand with our wonderful Operations team, and at the end of the day, we had a LOT of support across the business to work through the release script.","4930605f09a40","4930605f09a4",[],{"markDefs":239,"children":240,"_type":66,"style":67,"_key":244},[],[241],{"_type":44,"marks":242,"text":30,"_key":243},[],"d8f3e1c115f50","d8f3e1c115f5",{"caption":246,"_key":255,"children":10,"height":256,"extension":257,"hotspot":10,"_type":258,"alt":253,"asset":259,"url":261,"width":262},[247],{"_type":66,"style":67,"_key":248,"markDefs":249,"children":250},"e32e8bbf6726",[],[251],{"_type":44,"marks":252,"text":253,"_key":254},[],"The team celebrating the final release of BK (Book Keeper) with some BK (Burger King).","e32e8bbf67260","2419a45fbd7b",818,"webp","figureNews",{"_ref":260,"_type":28},"image-3d0402f2f90fb3b1bdb4c6dec228c8b828158520-1400x818-webp","https://cdn.sanity.io/images/40fnhjbe/production/3d0402f2f90fb3b1bdb4c6dec228c8b828158520-1400x818.webp",1400,{"style":161,"_key":264,"markDefs":265,"children":266,"_type":66},"51e685390ddd",[],[267],{"_type":44,"marks":268,"text":269,"_key":270},[167],"So, What Did We Learn?","51e685390ddd0",{"_type":66,"style":67,"_key":272,"markDefs":273,"children":274},"bb499b9ff816",[],[275],{"text":276,"_key":277,"_type":44,"marks":278},"Major lessons from the this journey were:","bb499b9ff8160",[],{"style":67,"_key":280,"listItem":281,"markDefs":282,"children":283,"level":292,"_type":66},"1ea40c428e5a","bullet",[],[284,288],{"_type":44,"marks":285,"text":286,"_key":287},[167],"Align your organization’s resources to make sure you have everything you need to mitigate risk and hit your dates, and in turn, be successful","1ea40c428e5a0",{"_type":44,"marks":289,"text":290,"_key":291},[],". Migrations are hard, like super hard. Every time. In Clear Street’s case, we had full support across the company. Our CEO, Chris Pento, understood the long-term timeline, the Operations team was available to help resolve subject matter questions or operational concerns and even validate the system, and all of the engineering teams were downstream to provide their feedback and expertise.","1ea40c428e5a1",1,{"children":294,"level":292,"_type":66,"style":67,"_key":303,"listItem":281,"markDefs":304},[295,299],{"marks":296,"text":297,"_key":298,"_type":44},[167],"Account for the “unknown unknowns.” ","83f1434b370e0",{"_type":44,"marks":300,"text":301,"_key":302},[],"In a complex system, it is unlikely that any one person will have a deep and comprehensive understanding of how everything works. It is even more unlikely that the knowledge can be effectively transferred without a good amount of effort. Another thing to consider is that when you work at a smaller scale, all problems seem easier, but once you move to production-sized loads, problems grow in complexity. All of these factors lead to “unknown unknowns,” problems you’ll have to solve that you cannot anticipate.","83f1434b370e1","83f1434b370e",[],{"listItem":281,"markDefs":306,"children":307,"level":292,"_type":66,"style":67,"_key":316},[],[308,312],{"_key":309,"_type":44,"marks":310,"text":311},"3f7ee144e9f30",[167],"Have a complete understanding of how the system you are replacing fits into your business processes",{"_type":44,"marks":313,"text":314,"_key":315},[]," and its downstream impact. We found success when we had a holistic view of all the upstream and downstream dependencies of the system we were replacing. We also found a lot of pain when we didn’t fully understand downstream use cases for the data produced by Bank.","3f7ee144e9f31","3f7ee144e9f3",{"level":292,"_type":66,"style":67,"_key":318,"listItem":281,"markDefs":319,"children":320},"1a86b34a5feb",[],[321,325],{"_key":322,"_type":44,"marks":323,"text":324},"1a86b34a5feb0",[167],"Validate and then validate again.",{"_type":44,"marks":326,"text":327,"_key":328},[]," When you replace system A with system B, and you want their output to match, the first step in building system B should be: How do I know if this thing works? This is of variable complexity by domain, and the risk profile is likely different as well. In our case both complexity and risk were high, so we invested heavily in our validation stack.","1a86b34a5feb1",{"level":292,"_type":66,"style":67,"_key":330,"listItem":281,"markDefs":331,"children":332},"7bc3b27a9591",[],[333,337],{"text":334,"_key":335,"_type":44,"marks":336},"Have a script.","7bc3b27a95910",[167],{"_type":44,"marks":338,"text":339,"_key":340},[]," In our migration execution plan, we wrote a comprehensive script that documented step by step what all stakeholders needed to do for a successful launch. Action items included things like, “scale down service A” and “verify replication lag by running this query on DB A.” This is a living document that should be iterated on, constantly. We did several dry runs of the migration in one of our lower environments and found many areas that needed improvement. By the end, the script eliminated a lot of human error. You’re unlikely to forget to “scale down service A” if it’s spelled out in the script.","7bc3b27a95911",{"style":67,"_key":342,"markDefs":343,"children":344,"_type":66},"dcc9eefd2bdd",[],[345],{"_type":44,"marks":346,"text":30,"_key":347},[],"dcc9eefd2bdd0",{"_key":349,"markDefs":350,"children":351,"_type":66,"style":67},"0a1ad85e8ca3",[],[352],{"marks":353,"text":354,"_key":355,"_type":44},[],"Success in performing large scale migrations is dependent on having a well thought-out plan and being incredibly thorough. Hot swapping Clear Street’s core system with a completely different one was a long and challenging journey, but it was absolutely worth it. We are now in a much better position to continue rapidly scaling our business with a much more solid foundation.","0a1ad85e8ca30",{"_type":66,"style":67,"_key":357,"markDefs":358,"children":359},"555f4fd4363b",[],[360],{"_type":44,"marks":361,"text":30,"_key":362},[],"555f4fd4363b0",{"_key":364,"markDefs":365,"children":369,"_type":66,"style":67},"d8bd08efc391",[366],{"_type":71,"to":367,"_key":368},"https://clearstreet.io/careers","42cc07d56252",[370,374,378],{"_type":44,"marks":371,"text":372,"_key":373},[],"If solving complex, highly rewarding problems interests you, check out our ","d8bd08efc3910",{"_type":44,"marks":375,"text":376,"_key":377},[368],"careers page","d8bd08efc3911",{"text":379,"_key":380,"_type":44,"marks":381},"!","d8bd08efc3912",[],[],[384,392],{"markDefs":385,"children":386,"_type":66,"style":67,"_key":391},[],[387],{"_type":44,"marks":388,"text":389,"_key":390},[167],"About Clear Street:","820e76cb468a0","01d9743bd6e6",{"style":67,"_key":393,"markDefs":394,"children":398,"_type":66},"6558fb161935",[395],{"_type":71,"href":396,"_key":397},"https://clearstreet.io","f69e401d33e9",[399,403,406],{"marks":400,"text":401,"_key":402,"_type":44},[],"Clear Street is modernizing the brokerage ecosystem with financial technology and services that empower market participants with real-time data and best-in-class products, tools and teams, to navigate capital markets around the world. Complemented by white-glove service, Clear Street's cloud-native, proprietary product suite delivers financing, derivatives, execution and more to power client success, adding efficiency to the market and enabling clients to minimize risk, redundancy and cost. Clear Street’s goal is to create a single platform for every asset class, in every country and in any currency. For more information, visit ","46cc6bc340df0",{"_type":44,"marks":404,"text":396,"_key":405},[397],"46cc6bc340df1",{"text":407,"_key":408,"_type":44,"marks":409},".","46cc6bc340df2",[],{"address":411,"disclaimer":412,"footerItems":439,"legalItems":471,"legalText":10,"socialNetworks":481},"4 World Trade Center\n150 Greenwich St Floor 45\nNew York, NY 10007\n(646) 845-0036",[413,423],{"markDefs":414,"children":417,"_type":66,"style":67,"_key":422},[415],{"_type":71,"href":72,"_key":416},"d38625939708",[418],{"_type":44,"marks":419,"text":420,"_key":421},[],"Products and services are offered by Clear Street LLC as a Broker Dealer member FINRA and SIPC and a Futures Commission Merchant registered with the CFTC and member of NFA. ","331699fdb6140","b41b74ae73bb",{"_type":66,"style":67,"_key":424,"markDefs":425,"children":427},"dbec5081eda7",[426],{"_type":71,"href":72,"_key":416},[428,432,435],{"marks":429,"text":430,"_key":431,"_type":44},[],"Additional information about Clear Street is available on FINRA ","42e587e4d749",{"text":52,"_key":433,"_type":44,"marks":434},"4894062c01ca",[416],{"_key":436,"_type":44,"marks":437,"text":438},"6db9006e1b4a",[],", including its Customer Relationship Summary and NFA BASIC | NFA (futures.org).",[440,453,465],{"title":104,"pages":441},[442,446,449,452],{"type":443,"title":444,"slug":445},"internal","About","about",{"type":443,"title":447,"slug":448},"News & Content","news",{"type":443,"title":450,"slug":451},"Careers","careers",{"type":443,"title":84,"slug":85},{"title":454,"pages":455},"Services",[456,459,462],{"type":443,"title":457,"slug":458},"Institutional","institutional",{"type":443,"title":460,"slug":461},"Professional Clearing","professional-clearing",{"type":443,"title":463,"slug":464},"Active Trader","active-trader",{"title":466,"pages":467},"Products",[468],{"type":443,"title":469,"slug":470},"Studio","studio",[472,475,478],{"title":473,"slug":474},"Regulatory Disclosures","regulatory-disclosures",{"title":476,"slug":477},"Privacy Policy","privacy-policy",{"title":479,"slug":480},"Security","security",[482,487,491,495],{"_type":483,"link":484,"socialNetwork":485,"_key":486},"links","https://github.com/clear-street","github","466192507eea",{"_type":483,"link":488,"socialNetwork":489,"_key":490},"https://www.linkedin.com/company/clear-street","linkedin","43f9fa8f49d0",{"_type":483,"link":492,"socialNetwork":493,"_key":494},"https://www.youtube.com/@ClearStreetNYC","youtube","b581a744d770",{"link":496,"socialNetwork":497,"_key":498,"_type":483},"https://open.spotify.com/show/3Bbl6x17ZSdnijTTDq6tKi","spotify","7625c0ffc2b2",1733511758051]