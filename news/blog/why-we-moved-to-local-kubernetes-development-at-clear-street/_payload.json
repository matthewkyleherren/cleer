[{"data":1,"prerenderedAt":1771},["ShallowReactive",2],{"TfvOCjxDAM":3},{"pageSetup":4,"sections":15},{"keywords":5,"image":6,"title":10,"slug":11,"description":14},null,{"url":7,"width":8,"height":9},"https://cdn.sanity.io/images/40fnhjbe/production/63982f496dd22411c6c8e573cb3f5785c4b99378-3840x2160.png",3840,2160,"Why We Moved to Local Kubernetes Development at Clear Street",{"current":12,"_type":13},"why-we-moved-to-local-kubernetes-development-at-clear-street","slug","Clear Street is a cloud-native financial technology firm on a mission to modernize the brokerage ecosystem.",{"header":16,"content":39,"footer":1682},{"summary":14,"author":17,"category":34,"title":10,"date":37,"hello":38},{"role":18,"photo":19,"_createdAt":26,"_rev":27,"_type":28,"name":29,"_id":30,"_updatedAt":31,"slug":32},"",{"asset":20,"url":23,"width":24,"height":24,"extension":25,"alt":5,"hotspot":5},{"_ref":21,"_type":22},"image-f9f54b5f5240dfdb9749b6abea1e0ea4720c0dee-480x480-png","reference","https://cdn.sanity.io/images/40fnhjbe/production/f9f54b5f5240dfdb9749b6abea1e0ea4720c0dee-480x480.png",480,"png","2024-02-16T14:38:42Z","oquihqXh9OzAvkinFGpwlk","authors","Clear Street Engineering","FY3Umrpkptjq2bXyZZikKw","2024-05-30T15:04:12Z",{"current":33,"_type":13},"clear-street-engineering",{"name":35,"colorSlug":36},"Engineering","engineering","2021-10-26","world",{"type":40,"readingTime":41,"body":42,"references":1587,"pressReleasesFootNote":1588,"legalText":1614,"form":1653},"blog",13,[43,53,61,68,77,84,104,111,119,129,137,144,152,159,169,177,184,192,200,208,215,223,231,239,247,255,263,271,312,320,338,345,353,360,368,376,384,392,399,407,415,423,431,439,447,455,462,501,508,516,523,531,550,569,576,584,591,599,606,614,621,629,636,644,651,659,666,674,681,689,697,705,713,721,729,737,756,764,772,780,788,795,803,810,818,825,833,840,848,856,864,872,880,887,895,903,921,928,936,943,950,958,966,974,982,990,998,1006,1014,1021,1029,1036,1044,1052,1059,1067,1075,1083,1090,1098,1106,1120,1127,1135,1142,1150,1157,1168,1185,1193,1201,1230,1237,1245,1253,1261,1269,1277,1285,1293,1301,1309,1317,1325,1333,1341,1349,1356,1375,1382,1390,1398,1406,1413,1421,1429,1437,1445,1453,1460,1468,1475,1483,1491,1499,1506,1514,1522,1530,1538,1557,1564,1572,1579],{"style":44,"_key":45,"markDefs":46,"children":47,"_type":52},"normal","6e23a0608751",[],[48],{"_type":49,"marks":50,"text":18,"_key":51},"span",[],"6e23a06087510","block",{"_type":52,"style":44,"_key":54,"markDefs":55,"children":56},"4667cf2b1151",[],[57],{"_type":49,"marks":58,"text":59,"_key":60},[],"At Clear Street, we run hundreds of services to provide prime brokerage products to our clients. Dozens of scheduled batch jobs process millions of trades, journals, and transactions every day to facilitate trade clearing, calculate risk, and generate financial reports.","4667cf2b11510",{"markDefs":62,"children":63,"_type":52,"style":44,"_key":67},[],[64],{"marks":65,"text":18,"_key":66,"_type":49},[],"4e3ac119e67d0","4e3ac119e67d",{"_type":69,"height":70,"asset":71,"children":5,"caption":73,"extension":25,"hotspot":5,"url":74,"width":75,"_key":76,"alt":18},"figureNews",302,{"_ref":72,"_type":22},"image-05427c02c7e0fd461d6b860e131f714b9abfe89f-1400x302-png",[],"https://cdn.sanity.io/images/40fnhjbe/production/05427c02c7e0fd461d6b860e131f714b9abfe89f-1400x302.png",1400,"4f09fd857d37",{"style":44,"_key":78,"markDefs":79,"children":80,"_type":52},"60b44eae0c8a",[],[81],{"_type":49,"marks":82,"text":18,"_key":83},[],"60b44eae0c8a0",{"_type":52,"style":44,"_key":85,"markDefs":86,"children":91},"74c596bb934b",[87],{"_key":88,"_type":89,"to":90},"bea9cfb137a3","link","https://argoproj.github.io/argo-workflows/",[92,96,100],{"_type":49,"marks":93,"text":94,"_key":95},[],"Our Kubernetes clusters manage all of these critical microservices and batch jobs; we rely on Kubernetes for networking, deployments, pod scaling, load balancing, node auto-scaling, cron jobs — the list goes on. So it might come as a surprise that developers at Clear Street weren’t using Kubernetes during their local development loop until this year. They weren’t able to leverage any Kubernetes features nor use Kubernetes-native infrastructure like ","74c596bb934b0",{"_type":49,"marks":97,"text":98,"_key":99},[88],"Argo","74c596bb934b1",{"marks":101,"text":102,"_key":103,"_type":49},[],".","74c596bb934b2",{"_type":52,"style":44,"_key":105,"markDefs":106,"children":107},"5bc93ad32e31",[],[108],{"text":18,"_key":109,"_type":49,"marks":110},"5bc93ad32e310",[],{"_key":112,"markDefs":113,"children":114,"_type":52,"style":44},"8aae457afb4e",[],[115],{"_key":116,"_type":49,"marks":117,"text":118},"8aae457afb4e0",[],"Today, nearly every Clear Street developer’s inner loop involves Kubernetes with what we’ve dubbed “localkube”: local development with Kubernetes.",{"style":120,"_key":121,"markDefs":122,"children":123,"_type":52},"h5","e240b4fc650d",[],[124],{"text":125,"_key":126,"_type":49,"marks":127},"Local development before localkube","e240b4fc650d0",[128],"strong",{"_key":130,"markDefs":131,"children":132,"_type":52,"style":44},"c57bd85709cf",[],[133],{"_key":134,"_type":49,"marks":135,"text":136},"c57bd85709cf0",[],"At the end of last year, we began to see repeating issues crop up with local development. Services’ local configuration was quite different from their cluster configuration: networking, service discovery, replication, pod readiness, and more were all different.",{"_type":52,"style":44,"_key":138,"markDefs":139,"children":140},"8e70773feefa",[],[141],{"_type":49,"marks":142,"text":18,"_key":143},[],"8e70773feefa0",{"_type":52,"style":44,"_key":145,"markDefs":146,"children":147},"dd0fe297a585",[],[148],{"text":149,"_key":150,"_type":49,"marks":151},"Eventually, local configuration issues started to eat into developer time. The problem was twofold:","dd0fe297a5850",[],{"_key":153,"markDefs":154,"children":155,"_type":52,"style":44},"c6ea2d3bc675",[],[156],{"_key":157,"_type":49,"marks":158,"text":18},"c6ea2d3bc6750",[],{"_key":160,"listItem":161,"markDefs":162,"children":163,"level":168,"_type":52,"style":44},"5904fcd853e5","bullet",[],[164],{"_type":49,"marks":165,"text":166,"_key":167},[],"We had to maintain separate local and cluster configurations (and code!).","5904fcd853e50",1,{"_key":170,"listItem":161,"markDefs":171,"children":172,"level":168,"_type":52,"style":44},"7b85570dddf1",[],[173],{"_type":49,"marks":174,"text":175,"_key":176},[],"Cluster configurations remained untested until deployed in our development cluster.","7b85570dddf10",{"_type":52,"style":44,"_key":178,"markDefs":179,"children":180},"b531b3af7187",[],[181],{"text":18,"_key":182,"_type":49,"marks":183},"f34ce76e4d97",[],{"markDefs":185,"children":186,"_type":52,"style":44,"_key":191},[],[187],{"_type":49,"marks":188,"text":189,"_key":190},[],"While using Docker Compose and Docker networks would solve some of these problems, we saw that as a half-baked solution that would still miss out on some essential Kubernetes features.","4dcc6a5361420","4dcc6a536142",{"style":120,"_key":193,"markDefs":194,"children":195,"_type":52},"b7910ee39efc",[],[196],{"_type":49,"marks":197,"text":198,"_key":199},[128],"Why use Kubernetes locally?","b7910ee39efc0",{"_key":201,"markDefs":202,"children":203,"_type":52,"style":44},"f60fa64a64c7",[],[204],{"_type":49,"marks":205,"text":206,"_key":207},[],"We decided to move to local Kubernetes development for the following benefits. It lets us:","f60fa64a64c70",{"children":209,"_type":52,"style":44,"_key":213,"markDefs":214},[210],{"text":18,"_key":211,"_type":49,"marks":212},"2f55fac3f1440",[],"2f55fac3f144",[],{"level":168,"_type":52,"style":44,"_key":216,"listItem":161,"markDefs":217,"children":218},"55960ee8e911",[],[219],{"_type":49,"marks":220,"text":221,"_key":222},[],"Bring local configuration as close as possible to our clusters.","55960ee8e9110",{"children":224,"level":168,"_type":52,"style":44,"_key":229,"listItem":161,"markDefs":230},[225],{"text":226,"_key":227,"_type":49,"marks":228},"Test Kubernetes configuration (resource limits, exposed ports/services, environment variables, liveness/readiness probes) earlier in our testing pipeline, even before code reaches our development cluster.","3486d4a55fd70",[],"3486d4a55fd7",[],{"level":168,"_type":52,"style":44,"_key":232,"listItem":161,"markDefs":233,"children":234},"d74cbd134639",[],[235],{"_type":49,"marks":236,"text":237,"_key":238},[],"Quickly test replicated services, including pod startup and shutdown behavior.","d74cbd1346390",{"_type":52,"style":44,"_key":240,"listItem":161,"markDefs":241,"children":242,"level":168},"edfab4c1cd7b",[],[243],{"_type":49,"marks":244,"text":245,"_key":246},[],"Develop and experiment with Kubernetes-native tools, like Argo and service meshes.","edfab4c1cd7b0",{"markDefs":248,"children":249,"level":168,"_type":52,"style":44,"_key":254,"listItem":161},[],[250],{"_type":49,"marks":251,"text":252,"_key":253},[],"Easily test upgrading Kubernetes.","30244fb113050","30244fb11305",{"listItem":161,"markDefs":256,"children":257,"level":168,"_type":52,"style":44,"_key":262},[],[258],{"_type":49,"marks":259,"text":260,"_key":261},[],"Remove our bespoke service startup scripts and reduce technical debt.","5d2eb32e6b180","5d2eb32e6b18",{"markDefs":264,"children":265,"_type":52,"style":120,"_key":270},[],[266],{"_type":49,"marks":267,"text":268,"_key":269},[128],"Our local Kubernetes tooling choices","30167a67116f0","30167a67116f",{"_type":52,"style":44,"_key":272,"markDefs":273,"children":283},"1b90a064587e",[274,277,280],{"_type":89,"to":275,"_key":276},"https://www.rookout.com/blog/developer-tooling-for-kubernetes-in-2021-part-2","89f3d2bb548e",{"to":278,"_key":279,"_type":89},"https://www.bizety.com/2020/07/02/kubernetes-tools-helm-skaffold-tilt-draft-and-garden/","1a35d9e5caa7",{"_type":89,"to":281,"_key":282},"https://medium.com/containers-101/the-ultimate-guide-for-local-development-on-kubernetes-draft-vs-skaffold-vs-garden-io-26a231c71210","e30a09179a45",[284,288,292,296,300,304,308],{"_type":49,"marks":285,"text":286,"_key":287},[],"This article won’t go into comparing tools — there are ","1b90a064587e0",{"_type":49,"marks":289,"text":290,"_key":291},[276],"plenty","1b90a064587e1",{"text":293,"_key":294,"_type":49,"marks":295}," of ","1b90a064587e2",[],{"_type":49,"marks":297,"text":298,"_key":299},[279],"articles","1b90a064587e3",{"_type":49,"marks":301,"text":302,"_key":303},[]," available ","1b90a064587e4",{"_type":49,"marks":305,"text":306,"_key":307},[282],"already","1b90a064587e5",{"_key":309,"_type":49,"marks":310,"text":311},"1b90a064587e6",[],". However, we include some reasons as to why we chose the tools we did.",{"_key":313,"markDefs":314,"children":315,"_type":52,"style":120},"53b7389cfb9d",[],[316],{"_key":317,"_type":49,"marks":318,"text":319},"53b7389cfb9d0",[128],"kind",{"_key":321,"markDefs":322,"children":326,"_type":52,"style":44},"38ddbf0ed6bf",[323],{"_type":89,"to":324,"_key":325},"https://kind.sigs.k8s.io/","e306162b6be0",[327,331,334],{"marks":328,"text":329,"_key":330,"_type":49},[],"First, we need to create a local Kubernetes cluster. We chose ","38ddbf0ed6bf0",{"marks":332,"text":319,"_key":333,"_type":49},[325],"38ddbf0ed6bf1",{"_type":49,"marks":335,"text":336,"_key":337},[]," because of its fast startup and shutdown speed, simplicity, good documentation, and community support.","38ddbf0ed6bf2",{"children":339,"_type":52,"style":44,"_key":343,"markDefs":344},[340],{"text":18,"_key":341,"_type":49,"marks":342},"8d6a0f5c92240",[],"8d6a0f5c9224",[],{"markDefs":346,"children":347,"_type":52,"style":44,"_key":352},[],[348],{"_type":49,"marks":349,"text":350,"_key":351},[],"After wrapping some startup configuration in a script, creating a local cluster is as simple as: make create-cluster","7d25a9270d450","7d25a9270d45",{"style":44,"_key":354,"markDefs":355,"children":356,"_type":52},"1e397c496389",[],[357],{"_key":358,"_type":49,"marks":359,"text":18},"1e397c4963890",[],{"children":361,"_type":52,"style":44,"_key":366,"markDefs":367},[362],{"_type":49,"marks":363,"text":364,"_key":365},[],"This does several things:","26c5cdd0dda3","0613a79cb368",[],{"_key":369,"listItem":161,"markDefs":370,"children":371,"level":168,"_type":52,"style":44},"11ea3fc4a681",[],[372],{"_type":49,"marks":373,"text":374,"_key":375},[],"Creates a Kubernetes cluster pinned to our production Kubernetes version.","11ea3fc4a6810",{"markDefs":377,"children":378,"level":168,"_type":52,"style":44,"_key":383,"listItem":161},[],[379],{"_key":380,"_type":49,"marks":381,"text":382},"e7b63444dca10",[],"Adds Ingress support to the cluster.","e7b63444dca1",{"markDefs":385,"children":386,"level":168,"_type":52,"style":44,"_key":391,"listItem":161},[],[387],{"marks":388,"text":389,"_key":390,"_type":49},[],"Creates a local Docker registry and connects the cluster to it.","9d2060db90250","9d2060db9025",{"_key":393,"markDefs":394,"children":395,"_type":52,"style":44},"3c3596dd3fa9",[],[396],{"_key":397,"_type":49,"marks":398,"text":18},"9065fb2e9350",[],{"style":44,"_key":400,"markDefs":401,"children":402,"_type":52},"a0e5be0066c6",[],[403],{"marks":404,"text":405,"_key":406,"_type":49},[],"Deleting or recreating the local cluster is simple as well:","a0e5be0066c60",{"style":44,"_key":408,"markDefs":409,"children":410,"_type":52},"70d71218617b",[],[411],{"_key":412,"_type":49,"marks":413,"text":414},"70d71218617b0",[],"# delete",{"style":44,"_key":416,"markDefs":417,"children":418,"_type":52},"49401584cb0d",[],[419],{"_type":49,"marks":420,"text":421,"_key":422},[],"make delete-cluster","49401584cb0d0",{"markDefs":424,"children":425,"_type":52,"style":44,"_key":430},[],[426],{"text":427,"_key":428,"_type":49,"marks":429},"# recreate","b15c0fe129e80",[],"b15c0fe129e8",{"markDefs":432,"children":433,"_type":52,"style":44,"_key":438},[],[434],{"_type":49,"marks":435,"text":436,"_key":437},[],"make delete-cluster create-cluster","5ea9e6d215ed0","5ea9e6d215ed",{"children":440,"_type":52,"style":120,"_key":445,"markDefs":446},[441],{"_type":49,"marks":442,"text":443,"_key":444},[128],"Tilt","9a701b95c5ca0","9a701b95c5ca",[],{"markDefs":448,"children":449,"_type":52,"style":44,"_key":454},[],[450],{"_type":49,"marks":451,"text":452,"_key":453},[],"Next, we found a solution for the “inner development loop”: code, build, run, repeat.","21d5a9cbf27f0","21d5a9cbf27f",{"_key":456,"markDefs":457,"children":458,"_type":52,"style":44},"f438298fba8d",[],[459],{"_type":49,"marks":460,"text":18,"_key":461},[],"f438298fba8d0",{"markDefs":463,"children":473,"_type":52,"style":44,"_key":500},[464,467,470],{"_type":89,"to":465,"_key":466},"https://skaffold.dev/","9f4276ac21f5",{"_type":89,"to":468,"_key":469},"https://garden.io/","5a73ddd5253a",{"_type":89,"to":471,"_key":472},"https://tilt.dev/","fd409a6d1be3",[474,478,482,486,490,494,497],{"marks":475,"text":476,"_key":477,"_type":49},[],"The tooling landscape for this task is extensive, with notable contenders being ","8f6d9a5673e30",{"_type":49,"marks":479,"text":480,"_key":481},[466],"skaffold","8f6d9a5673e31",{"_type":49,"marks":483,"text":484,"_key":485},[],", ","8f6d9a5673e32",{"marks":487,"text":488,"_key":489,"_type":49},[469],"garden","8f6d9a5673e33",{"_key":491,"_type":49,"marks":492,"text":493},"8f6d9a5673e34",[],", and ",{"marks":495,"text":443,"_key":496,"_type":49},[472],"8f6d9a5673e35",{"text":102,"_key":498,"_type":49,"marks":499},"8f6d9a5673e36",[],"8f6d9a5673e3",{"_key":502,"markDefs":503,"children":504,"_type":52,"style":44},"543a6458f962",[],[505],{"_type":49,"marks":506,"text":18,"_key":507},[],"543a6458f9620",{"_key":509,"markDefs":510,"children":511,"_type":52,"style":44},"4cd6ed1f4ebe",[],[512],{"marks":513,"text":514,"_key":515,"_type":49},[],"We chose Tilt for managing the inner development loop for the following reasons:","4cd6ed1f4ebe0",{"_key":517,"markDefs":518,"children":519,"_type":52,"style":44},"cadaf5eac2b1",[],[520],{"_type":49,"marks":521,"text":18,"_key":522},[],"a77b89c508b8",{"_key":524,"listItem":161,"markDefs":525,"children":526,"level":168,"_type":52,"style":44},"32e979da060f",[],[527],{"_type":49,"marks":528,"text":529,"_key":530},[],"Its simple web UI for log viewing and high-level information is essential for developers new to Kubernetes.","32e979da060f0",{"listItem":161,"markDefs":532,"children":536,"level":168,"_type":52,"style":44,"_key":549},[533],{"_type":89,"to":534,"_key":535},"https://docs.tilt.dev/live_update_reference.html","3626b9443ada",[537,541,545],{"_type":49,"marks":538,"text":539,"_key":540},[],"Its large feature set, including container building improvements like “","a9363c24db480",{"_type":49,"marks":542,"text":543,"_key":544},[535],"live update","a9363c24db481",{"_type":49,"marks":546,"text":547,"_key":548},[],".”","a9363c24db482","a9363c24db48",{"_key":551,"listItem":161,"markDefs":552,"children":556,"level":168,"_type":52,"style":44},"5c11d5963e1f",[553],{"to":554,"_key":555,"_type":89},"https://github.com/bazelbuild/starlark","52e39832e96f",[557,561,565],{"_type":49,"marks":558,"text":559,"_key":560},[],"The ","5c11d5963e1f0",{"_type":49,"marks":562,"text":563,"_key":564},[555],"Starlark","5c11d5963e1f1",{"_type":49,"marks":566,"text":567,"_key":568},[]," configuration language (a dialect of Python) is powerful and straightforward to learn.","5c11d5963e1f2",{"_key":570,"markDefs":571,"children":572,"_type":52,"style":44},"4c47a878675a",[],[573],{"_key":574,"_type":49,"marks":575,"text":18},"4c47a878675a0",[],{"_key":577,"markDefs":578,"children":579,"_type":52,"style":44},"eb66c223c3a0",[],[580],{"marks":581,"text":582,"_key":583,"_type":49},[],"Out-of-the-box, Tilt was easy to incorporate into our codebase. In about a week, we could launch most of our services in a local Kubernetes environment.","eb66c223c3a00",{"_type":52,"style":44,"_key":585,"markDefs":586,"children":587},"3eb952eb810b",[],[588],{"_type":49,"marks":589,"text":18,"_key":590},[],"3eb952eb810b0",{"markDefs":592,"children":593,"_type":52,"style":44,"_key":598},[],[594],{"_type":49,"marks":595,"text":596,"_key":597},[],"After describing how to build our images in Starlark, we tell Tilt the services we want to run, like bank and appliances:","c7806ff899f30","c7806ff899f3",{"_key":600,"markDefs":601,"children":602,"_type":52,"style":44},"0928e489d9e1",[],[603],{"_type":49,"marks":604,"text":18,"_key":605},[],"0928e489d9e10",{"_type":52,"style":44,"_key":607,"markDefs":608,"children":609},"c14cf23abb34",[],[610],{"_type":49,"marks":611,"text":612,"_key":613},[],"tilt up appliances bank","c14cf23abb340",{"_type":52,"style":44,"_key":615,"markDefs":616,"children":617},"1188c4e1b375",[],[618],{"_key":619,"_type":49,"marks":620,"text":18},"1188c4e1b3750",[],{"_type":52,"style":44,"_key":622,"markDefs":623,"children":624},"86d6394d93c6",[],[625],{"_type":49,"marks":626,"text":627,"_key":628},[],"Here, appliances is an alias to our shared core infrastructure: Postgres, Kafka, Schema Registry, etc.","86d6394d93c60",{"_key":630,"markDefs":631,"children":632,"_type":52,"style":44},"45fa2b4a6c97",[],[633],{"_type":49,"marks":634,"text":18,"_key":635},[],"45fa2b4a6c970",{"_type":52,"style":44,"_key":637,"markDefs":638,"children":639},"e8c52190897e",[],[640],{"_type":49,"marks":641,"text":642,"_key":643},[],"After running this command, Tilt serves a pleasant web UI with service status, build and runtime logs, service groupings, and Kubernetes information like Pod ID:","e8c52190897e0",{"children":645,"_type":52,"style":44,"_key":649,"markDefs":650},[646],{"text":18,"_key":647,"_type":49,"marks":648},"e945f313ace60",[],"e945f313ace6",[],{"style":44,"_key":652,"markDefs":653,"children":654,"_type":52},"a556e3fc978f",[],[655],{"_key":656,"_type":49,"marks":657,"text":658},"a556e3fc978f0",[],"Once Tilt detects that the code has changed, it will automatically update the correct service in your cluster!",{"_key":660,"markDefs":661,"children":662,"_type":52,"style":44},"6e6487033b62",[],[663],{"_type":49,"marks":664,"text":18,"_key":665},[],"6e6487033b620",{"markDefs":667,"children":668,"_type":52,"style":44,"_key":673},[],[669],{"_key":670,"_type":49,"marks":671,"text":672},"782954e1ecd60",[],"One of Tilt’s many valuable features is describing services’ dependencies. Above, we’ve only specified the bank service, but our Starlark configuration reads other YAML configuration files and figures out that bank needs several other services and launches those.","782954e1ecd6",{"_key":675,"markDefs":676,"children":677,"_type":52,"style":44},"d20f3c9534c8",[],[678],{"_type":49,"marks":679,"text":18,"_key":680},[],"d20f3c9534c80",{"markDefs":682,"children":683,"_type":52,"style":44,"_key":688},[],[684],{"_type":49,"marks":685,"text":686,"_key":687},[],"As a performance improvement, Tilt uses the local registry we set up earlier to send Docker images into the cluster quickly.","6afa9b2ff6de0","6afa9b2ff6de",{"children":690,"_type":52,"style":120,"_key":695,"markDefs":696},[691],{"_type":49,"marks":692,"text":693,"_key":694},[128],"Control loop","20efbfb73f790","20efbfb73f79",[],{"_type":52,"style":44,"_key":698,"markDefs":699,"children":700},"6c88ad198d2d",[],[701],{"_type":49,"marks":702,"text":703,"_key":704},[],"At its core, Tilt:","6c88ad198d2d0",{"level":168,"_type":52,"style":44,"_key":706,"listItem":161,"markDefs":707,"children":708},"43e00cde6317",[],[709],{"marks":710,"text":711,"_key":712,"_type":49},[],"Watches your filesystem for file changes","43e00cde63170",{"markDefs":714,"children":715,"level":168,"_type":52,"style":44,"_key":720,"listItem":161},[],[716],{"_type":49,"marks":717,"text":718,"_key":719},[],"Builds and tags Docker images of your services when files change","6f15e0129ab70","6f15e0129ab7",{"children":722,"level":168,"_type":52,"style":44,"_key":727,"listItem":161,"markDefs":728},[723],{"_type":49,"marks":724,"text":725,"_key":726},[],"Pushes images to the local registry","9fd4f59f6c600","9fd4f59f6c60",[],{"_type":52,"style":44,"_key":730,"listItem":161,"markDefs":731,"children":732,"level":168},"0547eb70a1b1",[],[733],{"_type":49,"marks":734,"text":735,"_key":736},[],"Tells Kubernetes to pull the new images and restart specific Pods","0547eb70a1b10",{"children":738,"_type":52,"style":44,"_key":752,"markDefs":753},[739,743,748],{"_type":49,"marks":740,"text":741,"_key":742},[],"Of course, it does ","34cd97490e390",{"_key":744,"_type":49,"marks":745,"text":747},"34cd97490e391",[746],"8dead4de4162","much, much more",{"_type":49,"marks":749,"text":750,"_key":751},[]," than this, and we rely on its extensive feature set for an improved developer experience.","34cd97490e392","34cd97490e39",[754],{"_type":89,"to":755,"_key":746},"https://docs.tilt.dev/",{"style":120,"_key":757,"markDefs":758,"children":759,"_type":52},"739b535b654b",[],[760],{"_type":49,"marks":761,"text":762,"_key":763},[128],"Tilt performance improvements","739b535b654b0",{"style":44,"_key":765,"markDefs":766,"children":767,"_type":52},"e0a0e9e8d133",[],[768],{"_type":49,"marks":769,"text":770,"_key":771},[],"After the initial honeymoon period with Tilt, we improved the local developer experience even more by speeding up Tilt’s inner loop.","e0a0e9e8d1330",{"markDefs":773,"children":774,"_type":52,"style":120,"_key":779},[],[775],{"_type":49,"marks":776,"text":777,"_key":778},[128],"Build caching","3ad250b6ab360","3ad250b6ab36",{"_type":52,"style":44,"_key":781,"markDefs":782,"children":783},"f6c2723d7b20",[],[784],{"_type":49,"marks":785,"text":786,"_key":787},[],"What if we want to launch 50 microservices to test some complicated workflows for a code change? At Clear Street, the time to build 50 Go, Node.js, and Python Docker images is unacceptable.","f6c2723d7b200",{"children":789,"_type":52,"style":44,"_key":793,"markDefs":794},[790],{"_type":49,"marks":791,"text":18,"_key":792},[],"09336ff0745c0","09336ff0745c",[],{"_type":52,"style":44,"_key":796,"markDefs":797,"children":798},"18c87fabb5a9",[],[799],{"_type":49,"marks":800,"text":801,"_key":802},[],"Instead, we use a performance trick: pull the latest-tagged Docker image for each service unless specified otherwise.","18c87fabb5a90",{"_key":804,"markDefs":805,"children":806,"_type":52,"style":44},"bcb9f42f9651",[],[807],{"marks":808,"text":18,"_key":809,"_type":49},[],"bcb9f42f96510",{"_type":52,"style":44,"_key":811,"markDefs":812,"children":813},"2adf298faf75",[],[814],{"_key":815,"_type":49,"marks":816,"text":817},"2adf298faf750",[],"For example:",{"children":819,"_type":52,"style":44,"_key":823,"markDefs":824},[820],{"_key":821,"_type":49,"marks":822,"text":18},"7d9ad21783600",[],"7d9ad2178360",[],{"_key":826,"markDefs":827,"children":828,"_type":52,"style":44},"b2f85d671cbd",[],[829],{"_type":49,"marks":830,"text":831,"_key":832},[],"tilt up appliances price -- --local bank","b2f85d671cbd0",{"style":44,"_key":834,"markDefs":835,"children":836,"_type":52},"3b272bf86f29",[],[837],{"_type":49,"marks":838,"text":18,"_key":839},[],"3b272bf86f290",{"children":841,"_type":52,"style":44,"_key":846,"markDefs":847},[842],{"_type":49,"marks":843,"text":844,"_key":845},[],"We use this syntax to say:","fa80f46e31650","fa80f46e3165",[],{"markDefs":849,"children":850,"level":168,"_type":52,"style":44,"_key":855,"listItem":161},[],[851],{"_key":852,"_type":49,"marks":853,"text":854},"b86a62060e950",[],"Launch appliances, bank, price, and their dependencies.","b86a62060e95",{"markDefs":857,"children":858,"level":168,"_type":52,"style":44,"_key":863,"listItem":161},[],[859],{"_type":49,"marks":860,"text":861,"_key":862},[],"For everything except bank, pull the latest image from our Docker registry.","fbc8a44353cb0","fbc8a44353cb",{"markDefs":865,"children":866,"level":168,"_type":52,"style":44,"_key":871,"listItem":161},[],[867],{"text":868,"_key":869,"_type":49,"marks":870},"Read the local filesystem for bank, build the Docker image, and inject it into the local cluster.","cee1107efaac0",[],"cee1107efaac",{"children":873,"_type":52,"style":44,"_key":878,"markDefs":879},[874],{"marks":875,"text":876,"_key":877,"_type":49},[],"Why does this caching mechanism work well? It’s because any code that merges to our main branch will automatically generate a new latest-tagged image. When the local branch is recent enough with the main branch, it will be running the same image as if it were built locally.","94f65311f85d0","94f65311f85d",[],{"_type":52,"style":44,"_key":881,"markDefs":882,"children":883},"dbef9a5c5ea0",[],[884],{"_type":49,"marks":885,"text":18,"_key":886},[],"dbef9a5c5ea00",{"children":888,"_type":52,"style":44,"_key":893,"markDefs":894},[889],{"marks":890,"text":891,"_key":892,"_type":49},[],"For our services, the time saved from caching is enormous. Additionally, restarts are fast because the local cluster caches the images.","9b387d80bbed0","9b387d80bbed",[],{"_type":52,"style":120,"_key":896,"markDefs":897,"children":898},"b5c6212d80b9",[],[899],{"_type":49,"marks":900,"text":901,"_key":902},[128],"Dockerfile best practices","b5c6212d80b90",{"_key":904,"markDefs":905,"children":909,"_type":52,"style":44},"2707867a1a85",[906],{"_type":89,"to":907,"_key":908},"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/","e7e7342c94da",[910,914,917],{"_type":49,"marks":911,"text":912,"_key":913},[],"By following the ","2707867a1a850",{"_type":49,"marks":915,"text":901,"_key":916},[908],"2707867a1a851",{"_type":49,"marks":918,"text":919,"_key":920},[]," from the beginning of Clear Street, we’ve benefited from fast reloading of Docker images: carefully ordering Docker layers goes a long way towards speeding up Docker builds.","2707867a1a852",{"_type":52,"style":44,"_key":922,"markDefs":923,"children":924},"621c1f24694e",[],[925],{"_key":926,"_type":49,"marks":927,"text":18},"621c1f24694e0",[],{"style":44,"_key":929,"markDefs":930,"children":931,"_type":52},"29a6e1dbe3e2",[],[932],{"_type":49,"marks":933,"text":934,"_key":935},[],"For example, Go Dockerfiles have:","29a6e1dbe3e20",{"markDefs":937,"children":938,"_type":52,"style":44,"_key":942},[],[939],{"text":18,"_key":940,"_type":49,"marks":941},"84737e7b3b5a0",[],"84737e7b3b5a",{"_key":944,"markDefs":945,"children":946,"_type":52,"style":44},"8b04de20591f",[],[947],{"_type":49,"marks":948,"text":18,"_key":949},[],"90184e582e00",{"_type":52,"style":44,"_key":951,"markDefs":952,"children":953},"063bc4a536e7",[],[954],{"_type":49,"marks":955,"text":956,"_key":957},[],"# Rarely changing code above","063bc4a536e70",{"children":959,"_type":52,"style":44,"_key":964,"markDefs":965},[960],{"_key":961,"_type":49,"marks":962,"text":963},"b4c0e0c86ade0",[],"COPY go.mod go.mod","b4c0e0c86ade",[],{"_key":967,"markDefs":968,"children":969,"_type":52,"style":44},"096f86ebbc32",[],[970],{"_type":49,"marks":971,"text":972,"_key":973},[],"COPY go.sum go.sum","096f86ebbc320",{"_key":975,"markDefs":976,"children":977,"_type":52,"style":44},"b1decd54189c",[],[978],{"marks":979,"text":980,"_key":981,"_type":49},[],"RUN go mod download","b1decd54189c0",{"_key":983,"markDefs":984,"children":985,"_type":52,"style":44},"3e2bd7dc4a3d",[],[986],{"marks":987,"text":988,"_key":989,"_type":49},[],"# Frequently changing below","3e2bd7dc4a3d0",{"_key":991,"markDefs":992,"children":993,"_type":52,"style":44},"092a0cfa151d",[],[994],{"_type":49,"marks":995,"text":996,"_key":997},[],"With a warm cache, Docker will altogether skip the go mod download as long as go.mod and go.sum haven’t changed.","092a0cfa151d0",{"_type":52,"style":120,"_key":999,"markDefs":1000,"children":1001},"3464ecaf7331",[],[1002],{"_type":49,"marks":1003,"text":1004,"_key":1005},[128],"live_update","3464ecaf73310",{"style":44,"_key":1007,"markDefs":1008,"children":1009,"_type":52},"58d5214285cd",[],[1010],{"_type":49,"marks":1011,"text":1012,"_key":1013},[],"Finally, some of our services benefited immensely from a Tilt feature called live_update. Rather than build a Dockefile from scratch every time, live_update lets us sync files into the container instantly and run arbitrary commands.","58d5214285cd0",{"_type":52,"style":44,"_key":1015,"markDefs":1016,"children":1017},"56b549f8b384",[],[1018],{"_key":1019,"_type":49,"marks":1020,"text":18},"56b549f8b3840",[],{"style":44,"_key":1022,"markDefs":1023,"children":1024,"_type":52},"8af1f2a9d8bc",[],[1025],{"marks":1026,"text":1027,"_key":1028,"_type":49},[],"For our Node.js services, we wanted to use nodemon because:","8af1f2a9d8bc0",{"children":1030,"_type":52,"style":44,"_key":1034,"markDefs":1035},[1031],{"_type":49,"marks":1032,"text":18,"_key":1033},[],"6c9ab49d81060","6c9ab49d8106",[],{"listItem":161,"markDefs":1037,"children":1038,"level":168,"_type":52,"style":44,"_key":1043},[],[1039],{"_type":49,"marks":1040,"text":1041,"_key":1042},[],"It’s how our engineers are used to working.","603cbdb0a2e40","603cbdb0a2e4",{"_type":52,"style":44,"_key":1045,"listItem":161,"markDefs":1046,"children":1047,"level":168},"522c019d5059",[],[1048],{"_type":49,"marks":1049,"text":1050,"_key":1051},[],"It can very quickly rebuild Node apps (under five seconds).","522c019d50590",{"markDefs":1053,"children":1054,"_type":52,"style":44,"_key":1058},[],[1055],{"_type":49,"marks":1056,"text":18,"_key":1057},[],"58326c34c8830","58326c34c883",{"markDefs":1060,"children":1061,"_type":52,"style":44,"_key":1066},[],[1062],{"_type":49,"marks":1063,"text":1064,"_key":1065},[],"With just a few lines of code in Starlark, we could automatically sync our Node.js services’ code into the container and run nodemon like normal. This brought the inner development loop speed to parity as before with those services.","075f42d74242","77292bd50425",{"_key":1068,"markDefs":1069,"children":1070,"_type":52,"style":120},"24a603c85071",[],[1071],{"_key":1072,"_type":49,"marks":1073,"text":1074},"24a603c850710",[128],"Interacting with the cluster",{"style":44,"_key":1076,"markDefs":1077,"children":1078,"_type":52},"f5bd1a0dddb1",[],[1079],{"_type":49,"marks":1080,"text":1081,"_key":1082},[],"While it’s great that our services run in a sandboxed Kubernetes cluster locally, a new challenge was breaking into the sandbox and interacting with services in the cluster.","f5bd1a0dddb10",{"children":1084,"_type":52,"style":44,"_key":1088,"markDefs":1089},[1085],{"_key":1086,"_type":49,"marks":1087,"text":18},"433f5fce53b40",[],"433f5fce53b4",[],{"_key":1091,"markDefs":1092,"children":1093,"_type":52,"style":44},"14d852cef093",[],[1094],{"_type":49,"marks":1095,"text":1096,"_key":1097},[],"A typical workflow at Clear Street is to use REST or gRPC endpoints to communicate with services, so we found a couple of different ways to support this workflow.","14d852cef0930",{"_type":52,"style":120,"_key":1099,"markDefs":1100,"children":1101},"8cddee846e24",[],[1102],{"_type":49,"marks":1103,"text":1104,"_key":1105},[128],"kubefwd","8cddee846e240",{"children":1107,"_type":52,"style":44,"_key":1116,"markDefs":1117},[1108,1112],{"_type":49,"marks":1109,"text":1104,"_key":1111},[1110],"5f28fc917190","5664cdb6a1190",{"_type":49,"marks":1113,"text":1114,"_key":1115},[]," is an open-source project that lets the host machine communicate as if it’s inside the cluster:","5664cdb6a1191","5664cdb6a119",[1118],{"_key":1110,"_type":89,"to":1119},"https://github.com/txn2/kubefwd",{"markDefs":1121,"children":1122,"_type":52,"style":44,"_key":1126},[],[1123],{"_type":49,"marks":1124,"text":18,"_key":1125},[],"88a5e2a8985a0","88a5e2a8985a",{"children":1128,"_type":52,"style":44,"_key":1133,"markDefs":1134},[1129],{"text":1130,"_key":1131,"_type":49,"marks":1132},"curl myservice.mynamespace:10000/metrics","34028db80e870",[],"34028db80e87",[],{"_key":1136,"markDefs":1137,"children":1138,"_type":52,"style":44},"bb60f98deff6",[],[1139],{"_type":49,"marks":1140,"text":18,"_key":1141},[],"bb60f98deff60",{"markDefs":1143,"children":1144,"_type":52,"style":44,"_key":1149},[],[1145],{"_type":49,"marks":1146,"text":1147,"_key":1148},[],"It does this by temporarily adding domain entries to your /etc/hosts file with the service names it forwards.","d41199c1d0d60","d41199c1d0d6",{"_key":1151,"markDefs":1152,"children":1153,"_type":52,"style":44},"37b98bb4835c",[],[1154],{"_type":49,"marks":1155,"text":18,"_key":1156},[],"37b98bb4835c0",{"_key":1158,"markDefs":1159,"children":1163,"_type":52,"style":44},"de66ec70126e",[1160],{"_type":89,"to":1161,"_key":1162},"https://github.com/txn2/kubefwd/issues/169#issuecomment-875936713","b99870ef9e8c",[1164],{"_type":49,"marks":1165,"text":1166,"_key":1167},[],"However, kubefwd is not a magic bullet:","de66ec70126e0",{"listItem":161,"markDefs":1169,"children":1171,"level":168,"_type":52,"style":44,"_key":1184},[1170],{"_key":1162,"_type":89,"to":1161},[1172,1176,1180],{"text":1173,"_key":1174,"_type":49,"marks":1175},"It does not support pod restarts and ","eeec7321b206",[],{"_type":49,"marks":1177,"text":1178,"_key":1179},[1162],"has no plan to do so","ba2bdc7472421",{"_type":49,"marks":1181,"text":1182,"_key":1183},[],". Constantly restarting kubefwd becomes tedious.","ba2bdc7472422","eac9473738d1",{"level":168,"_type":52,"style":44,"_key":1186,"listItem":161,"markDefs":1187,"children":1188},"a7a8ae4b3cc3",[],[1189],{"marks":1190,"text":1191,"_key":1192,"_type":49},[],"If not shut down appropriately, kubefwd can leave /etc/hosts in a bad state.","ec0445e6bb97",{"_type":52,"style":120,"_key":1194,"markDefs":1195,"children":1196},"fc567fc738ab",[],[1197],{"_type":49,"marks":1198,"text":1199,"_key":1200},[128],"Kubernetes Ingresses","fc567fc738ab0",{"_type":52,"style":44,"_key":1202,"markDefs":1203,"children":1210},"6f2bf38f72cb",[1204,1207],{"to":1205,"_key":1206,"_type":89},"https://kubernetes.io/docs/concepts/services-networking/ingress/","4b5e242aa35a",{"_type":89,"to":1208,"_key":1209},"https://kind.sigs.k8s.io/docs/user/ingress","a1de16532896",[1211,1215,1218,1222,1226],{"_type":49,"marks":1212,"text":1213,"_key":1214},[],"Another way to access services in a cluster is to use ","6f2bf38f72cb0",{"text":1199,"_key":1216,"_type":49,"marks":1217},"6f2bf38f72cb1",[1206],{"_key":1219,"_type":49,"marks":1220,"text":1221},"6f2bf38f72cb2",[],". By using the ",{"_type":49,"marks":1223,"text":1224,"_key":1225},[1209],"Ingress NGINX kind configuration","6f2bf38f72cb3",{"marks":1227,"text":1228,"_key":1229,"_type":49},[],", services can create something like this:","6f2bf38f72cb4",{"_key":1231,"markDefs":1232,"children":1233,"_type":52,"style":44},"bcbba87b06af",[],[1234],{"_type":49,"marks":1235,"text":18,"_key":1236},[],"bcbba87b06af0",{"markDefs":1238,"children":1239,"_type":52,"style":44,"_key":1244},[],[1240],{"_type":49,"marks":1241,"text":1242,"_key":1243},[],"apiVersion: networking.k8s.io/v1","0ad55b65ddb80","0ad55b65ddb8",{"_type":52,"style":44,"_key":1246,"markDefs":1247,"children":1248},"40be3141715e",[],[1249],{"text":1250,"_key":1251,"_type":49,"marks":1252},"kind: Ingress","40be3141715e0",[],{"_key":1254,"markDefs":1255,"children":1256,"_type":52,"style":44},"d17a4d2c2781",[],[1257],{"text":1258,"_key":1259,"_type":49,"marks":1260},"metadata:","d17a4d2c27810",[],{"style":44,"_key":1262,"markDefs":1263,"children":1264,"_type":52},"df208f18ebe5",[],[1265],{"marks":1266,"text":1267,"_key":1268,"_type":49},[],"name: sledfrontend","df208f18ebe50",{"style":44,"_key":1270,"markDefs":1271,"children":1272,"_type":52},"c2cf468dfd35",[],[1273],{"_type":49,"marks":1274,"text":1275,"_key":1276},[],"# ...","c2cf468dfd350",{"markDefs":1278,"children":1279,"_type":52,"style":44,"_key":1284},[],[1280],{"_type":49,"marks":1281,"text":1282,"_key":1283},[],"spec:","60cabddf77200","60cabddf7720",{"style":44,"_key":1286,"markDefs":1287,"children":1288,"_type":52},"f0229ba82860",[],[1289],{"_type":49,"marks":1290,"text":1291,"_key":1292},[],"rules:","f0229ba828600",{"markDefs":1294,"children":1295,"_type":52,"style":44,"_key":1300},[],[1296],{"_type":49,"marks":1297,"text":1298,"_key":1299},[],"- host: sledfrontend.localkube.co.clearstreet.io","a2474151bad60","a2474151bad6",{"style":44,"_key":1302,"markDefs":1303,"children":1304,"_type":52},"8772960f694b",[],[1305],{"_type":49,"marks":1306,"text":1307,"_key":1308},[],"  http:","8772960f694b0",{"markDefs":1310,"children":1311,"_type":52,"style":44,"_key":1316},[],[1312],{"text":1313,"_key":1314,"_type":49,"marks":1315},"    paths:","f933721644570",[],"f93372164457",{"_key":1318,"markDefs":1319,"children":1320,"_type":52,"style":44},"779a0160b608",[],[1321],{"_type":49,"marks":1322,"text":1323,"_key":1324},[],"    - backend:","779a0160b6080",{"children":1326,"_type":52,"style":44,"_key":1331,"markDefs":1332},[1327],{"text":1328,"_key":1329,"_type":49,"marks":1330},"       serviceName: sledfrontend","a56bf15a95e30",[],"a56bf15a95e3",[],{"_key":1334,"markDefs":1335,"children":1336,"_type":52,"style":44},"a90fe9f5a238",[],[1337],{"_type":49,"marks":1338,"text":1339,"_key":1340},[],"       servicePort: 5000","a90fe9f5a2380",{"markDefs":1342,"children":1343,"_type":52,"style":44,"_key":1348},[],[1344],{"_type":49,"marks":1345,"text":1346,"_key":1347},[],"       path: /","5550c63fa92f0","5550c63fa92f",{"_type":52,"style":44,"_key":1350,"markDefs":1351,"children":1352},"077fb150f4b5",[],[1353],{"_key":1354,"_type":49,"marks":1355,"text":18},"077fb150f4b50",[],{"_key":1357,"markDefs":1358,"children":1362,"_type":52,"style":44},"f54fddd0c856",[1359],{"_type":89,"to":1360,"_key":1361},"https://medium.com/clear-street/service-level-deploys-or-how-we-learned-to-stop-worrying-and-love-artifacts-6daca4c32fe0","2e5bf907ead0",[1363,1367,1371],{"marks":1364,"text":1365,"_key":1366,"_type":49},[],"When running our ","f54fddd0c8560",{"marks":1368,"text":1369,"_key":1370,"_type":49},[1361],"SLeD service","f54fddd0c8561",{"marks":1372,"text":1373,"_key":1374,"_type":49},[]," locally, users can access sledfrontend.localkube.co.clearstreet.io and be redirected to sledfrontend:5000 in the cluster.","f54fddd0c8562",{"_key":1376,"markDefs":1377,"children":1378,"_type":52,"style":44},"5d60b46dd0a3",[],[1379],{"marks":1380,"text":18,"_key":1381,"_type":49},[],"5d60b46dd0a30",{"_type":52,"style":44,"_key":1383,"markDefs":1384,"children":1385},"8c90514ae57a",[],[1386],{"text":1387,"_key":1388,"_type":49,"marks":1389},"Our Route53 redirects *.localkube.co.clearstreet.io to the loopback address, 127.0.0.1, which the Kubernetes Ingress is listening to. Developers can use this to test subdomain routing or access their services through ingresses locally.","8c90514ae57a0",[],{"_type":52,"style":120,"_key":1391,"markDefs":1392,"children":1393},"5ffb6943d2e0",[],[1394],{"_type":49,"marks":1395,"text":1396,"_key":1397},[128],"Outcomes","5ffb6943d2e00",{"style":44,"_key":1399,"markDefs":1400,"children":1401,"_type":52},"4cc5f1ea9c6d",[],[1402],{"marks":1403,"text":1404,"_key":1405,"_type":49},[],"After rolling out localkube, we saw developers take off with the new capabilities. We:","4cc5f1ea9c6d0",{"_type":52,"style":44,"_key":1407,"markDefs":1408,"children":1409},"c63336c8206c",[],[1410],{"_type":49,"marks":1411,"text":18,"_key":1412},[],"c63336c8206c0",{"_key":1414,"listItem":161,"markDefs":1415,"children":1416,"level":168,"_type":52,"style":44},"0d6a93e158fe",[],[1417],{"marks":1418,"text":1419,"_key":1420,"_type":49},[],"Began using Argo Workflows and Argo Events.","0d6a93e158fe0",{"_key":1422,"listItem":161,"markDefs":1423,"children":1424,"level":168,"_type":52,"style":44},"fa353c86d84c",[],[1425],{"text":1426,"_key":1427,"_type":49,"marks":1428},"Created sandboxed environments in the cloud for a specific branch (more on that in a future blog post!).","fa353c86d84c0",[],{"_type":52,"style":44,"_key":1430,"listItem":161,"markDefs":1431,"children":1432,"level":168},"f2278d412eb5",[],[1433],{"_type":49,"marks":1434,"text":1435,"_key":1436},[],"Tested deployments before merging to our main branch.","f2278d412eb50",{"children":1438,"level":168,"_type":52,"style":44,"_key":1443,"listItem":161,"markDefs":1444},[1439],{"_type":49,"marks":1440,"text":1441,"_key":1442},[],"Tried out more Kubernetes-native tools like service meshes.","701e10d2e6d50","701e10d2e6d5",[],{"markDefs":1446,"children":1447,"level":168,"_type":52,"style":44,"_key":1452,"listItem":161},[],[1448],{"_type":49,"marks":1449,"text":1450,"_key":1451},[],"Gained higher confidence and a lower failure rate in production.","ffd7bb617cd00","ffd7bb617cd0",{"style":44,"_key":1454,"markDefs":1455,"children":1456,"_type":52},"31b05b278cb0",[],[1457],{"_key":1458,"_type":49,"marks":1459,"text":18},"31b05b278cb00",[],{"markDefs":1461,"children":1462,"_type":52,"style":44,"_key":1467},[],[1463],{"_key":1464,"_type":49,"marks":1465,"text":1466},"52595e1efdb80",[],"The Tilt UI has been instrumental in developer experience and has helped us teach Kubernetes and Docker to more Clear Street developers. Additionally, switching branches and work contexts has never been easier for us.","52595e1efdb8",{"_key":1469,"markDefs":1470,"children":1471,"_type":52,"style":44},"00e1473ff566",[],[1472],{"_type":49,"marks":1473,"text":18,"_key":1474},[],"00e1473ff5660",{"children":1476,"_type":52,"style":44,"_key":1481,"markDefs":1482},[1477],{"_key":1478,"_type":49,"marks":1479,"text":1480},"aac05ce7a4510",[],"The Tilt team has been great to work with; they’ve helped us onboard more developer workflows and have promptly released features that we have requested.","aac05ce7a451",[],{"children":1484,"_type":52,"style":120,"_key":1489,"markDefs":1490},[1485],{"_key":1486,"_type":49,"marks":1487,"text":1488},"6fc6cc2e0a210",[128],"Why not use Kubernetes locally?","6fc6cc2e0a21",[],{"style":44,"_key":1492,"markDefs":1493,"children":1494,"_type":52},"56ae1e234aca",[],[1495],{"_key":1496,"_type":49,"marks":1497,"text":1498},"56ae1e234aca0",[],"Despite all the benefits listed in this article, running Kubernetes might not be the best idea for every company for such reasons as:",{"_key":1500,"markDefs":1501,"children":1502,"_type":52,"style":44},"a58615c49753",[],[1503],{"_type":49,"marks":1504,"text":18,"_key":1505},[],"a58615c497530",{"children":1507,"level":168,"_type":52,"style":44,"_key":1512,"listItem":161,"markDefs":1513},[1508],{"marks":1509,"text":1510,"_key":1511,"_type":49},[],"Potentially slower inner development loop, especially if not enough resources are devoted to improving caching.","eb20a5b6e23b0","eb20a5b6e23b",[],{"_type":52,"style":44,"_key":1515,"listItem":161,"markDefs":1516,"children":1517,"level":168},"5eace3d87ada",[],[1518],{"marks":1519,"text":1520,"_key":1521,"_type":49},[],"With Docker-based local development, it can be tricky to set up debugging and may require juggling several different Dockerfiles.","5eace3d87ada0",{"children":1523,"level":168,"_type":52,"style":44,"_key":1528,"listItem":161,"markDefs":1529},[1524],{"_key":1525,"_type":49,"marks":1526,"text":1527},"bba83f7ce0c70",[],"Onboarding developers to Kubernetes basics is necessary to run and debug Kubernetes locally. DevOps practitioners would say this is a great thing, but not every company thinks so.","bba83f7ce0c7",[],{"markDefs":1531,"children":1532,"_type":52,"style":120,"_key":1537},[],[1533],{"marks":1534,"text":1535,"_key":1536,"_type":49},[128],"Looking forward","3f398473918b0","3f398473918b",{"_type":52,"style":44,"_key":1539,"markDefs":1540,"children":1544},"a2378afe2370",[1541],{"_key":1542,"_type":89,"to":1543},"c0b4cc4a6656","https://docs.tilt.dev/debuggers_python.html",[1545,1549,1553],{"text":1546,"_key":1547,"_type":49,"marks":1548},"Our developers are excited by this new workflow and are looking forward to more improvements down the road. For example, we don’t support debugging services running in a cluster yet. Luckily, ","a2378afe23700",[],{"text":1550,"_key":1551,"_type":49,"marks":1552},"Tilt has a guide for this","a2378afe23701",[1542],{"_type":49,"marks":1554,"text":1555,"_key":1556},[],", and we’re planning on enabling it soon.","a2378afe23702",{"markDefs":1558,"children":1559,"_type":52,"style":44,"_key":1563},[],[1560],{"text":18,"_key":1561,"_type":49,"marks":1562},"97363fd21a640",[],"97363fd21a64",{"_type":52,"style":44,"_key":1565,"markDefs":1566,"children":1567},"a4e1aa9ea6a0",[],[1568],{"_type":49,"marks":1569,"text":1570,"_key":1571},[],"One long-desired feature at Clear Street was branch deploys: ephemeral, sandboxed, cloud environments built from a single source branch. Because of Tilt and localkube, we’ve been able to create and delete these ephemeral environments quickly. For the tech behind that, stay tuned for a future blog!","a4e1aa9ea6a00",{"markDefs":1573,"children":1574,"_type":52,"style":44,"_key":1578},[],[1575],{"_type":49,"marks":1576,"text":18,"_key":1577},[],"44d2374108f50","44d2374108f5",{"children":1580,"_type":52,"style":44,"_key":1585,"markDefs":1586},[1581],{"marks":1582,"text":1583,"_key":1584,"_type":49},[],"Finally, things keep getting better in the local Kubernetes development landscape. Kind has gotten more stable, and the Tilt team consistently improves the tool with the features we request. There is no looking back for Clear Street: local Kubernetes development with these tools has improved developer experience and reduced production risk.","9332e1cb19440","9332e1cb1944",[],[],[1589,1597],{"_key":1590,"markDefs":1591,"children":1592,"_type":52,"style":44},"01d9743bd6e6",[],[1593],{"_type":49,"marks":1594,"text":1595,"_key":1596},[128],"About Clear Street:","820e76cb468a0",{"_key":1598,"markDefs":1599,"children":1603,"_type":52,"style":44},"6558fb161935",[1600],{"_type":89,"href":1601,"_key":1602},"https://clearstreet.io","f69e401d33e9",[1604,1608,1611],{"_type":49,"marks":1605,"text":1606,"_key":1607},[],"Clear Street is modernizing the brokerage ecosystem with financial technology and services that empower market participants with real-time data and best-in-class products, tools and teams, to navigate capital markets around the world. Complemented by white-glove service, Clear Street's cloud-native, proprietary product suite delivers financing, derivatives, execution and more to power client success, adding efficiency to the market and enabling clients to minimize risk, redundancy and cost. Clear Street’s goal is to create a single platform for every asset class, in every country and in any currency. For more information, visit ","46cc6bc340df0",{"_key":1609,"_type":49,"marks":1610,"text":1601},"46cc6bc340df1",[1602],{"_type":49,"marks":1612,"text":102,"_key":1613},[],"46cc6bc340df2",[1615,1645],{"_type":52,"style":44,"_key":1616,"markDefs":1617,"children":1624},"cd3115128082",[1618,1621],{"_type":89,"href":1619,"_key":1620},"https://brokercheck.finra.org/firm/summary/288933","10659f16c05f",{"_type":89,"href":1622,"_key":1623},"https://www.nfa.futures.org/BasicNet/basic-profile.aspx?nfaid=XCoGScQYyvw%3D","3c111ef5e988",[1625,1629,1633,1637,1641],{"_key":1626,"_type":49,"marks":1627,"text":1628},"e217f565c4110",[],"Clear Street does not provide investment, legal, regulatory, tax, or compliance advice. Consult professionals in these fields to address your specific circumstances. These materials are: (i) solely an overview of Clear Street’s products and services; (ii) provided for informational purposes only; and (iii) subject to change without notice or obligation to replace any information contained therein.\n\nProducts and services are offered by Clear Street LLC as a Broker Dealer member FINRA and SIPC and a Futures Commission Merchant registered with the CFTC and member of NFA. Additional information about Clear Street is available on FINRA ",{"_type":49,"marks":1630,"text":1631,"_key":1632},[1620],"BrokerCheck","e217f565c4111",{"_type":49,"marks":1634,"text":1635,"_key":1636},[],", including its Customer Relationship Summary and NFA ","e217f565c4112",{"text":1638,"_key":1639,"_type":49,"marks":1640},"BASIC | NFA (futures.org)","e217f565c4113",[1623],{"_type":49,"marks":1642,"text":1643,"_key":1644},[],".\n‍\nCopyright © 2024 Clear Street LLC. All rights reserved. Clear Street and the Shield Logo are Registered Trademarks of Clear Street LLC\n","e217f565c4114",{"_type":52,"style":44,"_key":1646,"markDefs":1647,"children":1648},"38805a72b34d",[],[1649],{"text":1650,"_key":1651,"_type":49,"marks":1652},"\n","a19adde9170f0",[],{"title":1654,"slug":1655,"fields":1656},"Contact","contact",[1657,1663,1668,1673,1677],{"label":1658,"required":1659,"errorMessage":1660,"_type":1661,"name":1662},"Full name",true,"Please add your full name","field.string","full-name",{"label":1664,"required":1659,"errorMessage":1665,"_type":1666,"name":1667},"Work email","Invalid email","field.email","work-email",{"required":1659,"errorMessage":1669,"_type":1670,"name":1671,"label":1672},"Please add your work phone","field.phone","work-phone","Work phone",{"errorMessage":1674,"_type":1661,"name":1675,"label":1676,"required":1659},"Please add your company","company","Company",{"name":1678,"label":1679,"required":1680,"errorMessage":5,"_type":1681},"message","Message (optional)",false,"field.text",{"legalText":5,"socialNetworks":1683,"address":1701,"disclaimer":1702,"footerItems":1729,"legalItems":1761},[1684,1689,1693,1697],{"_type":1685,"link":1686,"socialNetwork":1687,"_key":1688},"links","https://github.com/clear-street","github","466192507eea",{"_type":1685,"link":1690,"socialNetwork":1691,"_key":1692},"https://www.linkedin.com/company/clear-street","linkedin","43f9fa8f49d0",{"_type":1685,"link":1694,"socialNetwork":1695,"_key":1696},"https://www.youtube.com/@ClearStreetNYC","youtube","b581a744d770",{"socialNetwork":1698,"_key":1699,"_type":1685,"link":1700},"spotify","7625c0ffc2b2","https://open.spotify.com/show/3Bbl6x17ZSdnijTTDq6tKi","4 World Trade Center\n150 Greenwich St Floor 45\nNew York, NY 10007\n(646) 845-0036",[1703,1713],{"markDefs":1704,"children":1707,"_type":52,"style":44,"_key":1712},[1705],{"_type":89,"href":1619,"_key":1706},"d38625939708",[1708],{"_key":1709,"_type":49,"marks":1710,"text":1711},"331699fdb6140",[],"Products and services are offered by Clear Street LLC as a Broker Dealer member FINRA and SIPC and a Futures Commission Merchant registered with the CFTC and member of NFA. ","b41b74ae73bb",{"children":1714,"_type":52,"style":44,"_key":1726,"markDefs":1727},[1715,1719,1722],{"text":1716,"_key":1717,"_type":49,"marks":1718},"Additional information about Clear Street is available on FINRA ","42e587e4d749",[],{"_type":49,"marks":1720,"text":1631,"_key":1721},[1706],"4894062c01ca",{"text":1723,"_key":1724,"_type":49,"marks":1725},", including its Customer Relationship Summary and NFA BASIC | NFA (futures.org).","6db9006e1b4a",[],"dbec5081eda7",[1728],{"_type":89,"href":1619,"_key":1706},[1730,1743,1755],{"title":1676,"pages":1731},[1732,1736,1739,1742],{"type":1733,"title":1734,"slug":1735},"internal","About","about",{"type":1733,"title":1737,"slug":1738},"News & Content","news",{"type":1733,"title":1740,"slug":1741},"Careers","careers",{"type":1733,"title":1654,"slug":1655},{"title":1744,"pages":1745},"Services",[1746,1749,1752],{"type":1733,"title":1747,"slug":1748},"Institutional","institutional",{"type":1733,"title":1750,"slug":1751},"Professional Clearing","professional-clearing",{"type":1733,"title":1753,"slug":1754},"Active Trader","active-trader",{"title":1756,"pages":1757},"Products",[1758],{"type":1733,"title":1759,"slug":1760},"Studio","studio",[1762,1765,1768],{"title":1763,"slug":1764},"Regulatory Disclosures","regulatory-disclosures",{"title":1766,"slug":1767},"Privacy Policy","privacy-policy",{"title":1769,"slug":1770},"Security","security",1733511759721]