[{"data":1,"prerenderedAt":869},["ShallowReactive",2],{"CdoD3gWXfo":3},{"pageSetup":4,"sections":15},{"slug":5,"description":8,"keywords":9,"image":10,"title":14},{"current":6,"_type":7},"switching-to-protobuf-from-avro-on-kafka","slug","Clear Street is a cloud-native financial technology firm on a mission to modernize the brokerage ecosystem.",null,{"url":11,"width":12,"height":13},"https://cdn.sanity.io/images/40fnhjbe/production/d35d2fd69bbd971e189f58d25656711704364e54-3840x2160.png",3840,2160,"Switching to Protobuf (from Avro) on Kafka",{"header":16,"content":46,"footer":780},{"summary":8,"author":17,"category":41,"title":14,"date":44,"hello":45},{"name":18,"_createdAt":19,"slug":20,"photo":22,"_rev":36,"_type":37,"_id":38,"role":39,"_updatedAt":40},"Tanishq Dubey","2024-02-16T14:38:42Z",{"current":21,"_type":7},"tanishq-dubey",{"asset":23,"url":26,"width":27,"height":28,"extension":29,"alt":18,"hotspot":30},{"_ref":24,"_type":25},"image-62796a8535c3a523884e3847db6d1c0a998e139e-3000x4500-jpg","reference","https://cdn.sanity.io/images/40fnhjbe/production/62796a8535c3a523884e3847db6d1c0a998e139e-3000x4500.jpg",3000,4500,"jpg",{"_type":31,"width":32,"x":33,"y":34,"height":35},"sanity.imageHotspot",0.9988722818422834,0.5003681940292193,0.3809444699063626,0.5811170332595327,"oquihqXh9OzAvkinFGn7wf","authors","HDYpJujF7Re3qdeulZkF65","Software Engineer","2024-05-30T14:45:25Z",{"name":42,"colorSlug":43},"Engineering","engineering","2023-01-27","world",{"legalText":47,"form":90,"type":119,"readingTime":120,"body":121,"references":752,"pressReleasesFootNote":753},[48,82],{"_type":49,"style":50,"_key":51,"markDefs":52,"children":60},"block","normal","cd3115128082",[53,57],{"_type":54,"href":55,"_key":56},"link","https://brokercheck.finra.org/firm/summary/288933","10659f16c05f",{"_type":54,"href":58,"_key":59},"https://www.nfa.futures.org/BasicNet/basic-profile.aspx?nfaid=XCoGScQYyvw%3D","3c111ef5e988",[61,66,70,74,78],{"_type":62,"marks":63,"text":64,"_key":65},"span",[],"Clear Street does not provide investment, legal, regulatory, tax, or compliance advice. Consult professionals in these fields to address your specific circumstances. These materials are: (i) solely an overview of Clear Street’s products and services; (ii) provided for informational purposes only; and (iii) subject to change without notice or obligation to replace any information contained therein.\n\nProducts and services are offered by Clear Street LLC as a Broker Dealer member FINRA and SIPC and a Futures Commission Merchant registered with the CFTC and member of NFA. Additional information about Clear Street is available on FINRA ","e217f565c4110",{"_type":62,"marks":67,"text":68,"_key":69},[56],"BrokerCheck","e217f565c4111",{"_type":62,"marks":71,"text":72,"_key":73},[],", including its Customer Relationship Summary and NFA ","e217f565c4112",{"_type":62,"marks":75,"text":76,"_key":77},[59],"BASIC | NFA (futures.org)","e217f565c4113",{"_type":62,"marks":79,"text":80,"_key":81},[],".\n‍\nCopyright © 2024 Clear Street LLC. All rights reserved. Clear Street and the Shield Logo are Registered Trademarks of Clear Street LLC\n","e217f565c4114",{"markDefs":83,"children":84,"_type":49,"style":50,"_key":89},[],[85],{"text":86,"_key":87,"_type":62,"marks":88},"\n","a19adde9170f0",[],"38805a72b34d",{"title":91,"slug":92,"fields":93},"Contact","contact",[94,100,105,110,114],{"name":95,"label":96,"required":97,"errorMessage":98,"_type":99},"full-name","Full name",true,"Please add your full name","field.string",{"name":101,"label":102,"required":97,"errorMessage":103,"_type":104},"work-email","Work email","Invalid email","field.email",{"label":106,"required":97,"errorMessage":107,"_type":108,"name":109},"Work phone","Please add your work phone","field.phone","work-phone",{"required":97,"errorMessage":111,"_type":99,"name":112,"label":113},"Please add your company","company","Company",{"required":115,"errorMessage":9,"_type":116,"name":117,"label":118},false,"field.text","message","Message (optional)","blog",9,[122,137,145,164,171,179,189,197,204,212,219,227,235,243,250,258,265,275,282,290,297,305,313,321,328,336,346,354,362,370,377,385,392,400,407,413,421,428,436,444,452,460,468,476,483,491,498,504,511,519,526,532,539,547,555,563,582,597,605,613,620,628,635,643,650,656,664,672,680,687,695,702,721,729,737,744],{"style":50,"_key":123,"markDefs":124,"children":128,"_type":49},"a94a6a735d24",[125],{"_type":54,"to":126,"_key":127},"https://clearstreet.io/","04a778aa9c3c",[129,133],{"_type":62,"marks":130,"text":131,"_key":132},[127],"Clear Street","a94a6a735d240",{"_type":62,"marks":134,"text":135,"_key":136},[]," is a fintech building modern infrastructure for capital markets and reimagining the legacy workflows and silos that are essential to increasing access in the financial markets, all while transparently decreasing risks and costs.","a94a6a735d241",{"_key":138,"markDefs":139,"children":140,"_type":49,"style":50},"64057e47b81f",[],[141],{"_type":62,"marks":142,"text":143,"_key":144},[],"","64057e47b81f0",{"children":146,"_type":49,"style":50,"_key":160,"markDefs":161},[147,151,156],{"_key":148,"_type":62,"marks":149,"text":150},"d4aa9105d9640",[],"Our platform is built on a modern foundation ",{"_key":152,"_type":62,"marks":153,"text":155},"d4aa9105d9641",[154],"ddba51ac23b9","designed around Kafka",{"text":157,"_key":158,"_type":62,"marks":159}," and tightly integrated into the AWS cloud, giving us horizontal and vertical scalability. Our architecture lets us easily decompose complex finance business logic into manageable chunks, or microservices, and Kafka’s democratization of data access and data flows make it easy for us to create an event-sourced architecture.","d4aa9105d9642",[],"d4aa9105d964",[162],{"_type":54,"to":163,"_key":154},"https://cdn.sanity.io/files/40fnhjbe/production/4206fc1b4a67fc341a4a0ea3ee3033afb02f89b0.pdf",{"markDefs":165,"children":166,"_type":49,"style":50,"_key":170},[],[167],{"_type":62,"marks":168,"text":143,"_key":169},[],"41b55413dde50","41b55413dde5",{"_type":49,"style":50,"_key":172,"markDefs":173,"children":174},"8e6c9421c74b",[],[175],{"text":176,"_key":177,"_type":62,"marks":178},"However, we’ve learned along the way that even modern technology, like Kafka, sometimes needs a new approach and that the most common approaches aren’t always the most effective. This is why we decided to move from Avro to Protobuf on Kafka.","8e6c9421c74b0",[],{"_type":49,"style":180,"_key":181,"markDefs":182,"children":183},"h5","bf77aff88573",[],[184],{"_type":62,"marks":185,"text":187,"_key":188},[186],"strong","Back to 2018: JSON + REST","bf77aff885730",{"markDefs":190,"children":191,"_type":49,"style":50,"_key":196},[],[192],{"_key":193,"_type":62,"marks":194,"text":195},"e09c82dcc8b30",[],"Some background will help set the stage for our decision-making. When we started in 2018, we were mostly using JSON over standard REST APIs as a format for communicating between services we’d written. At the time, our priority was simple — clearing trades. We weren’t focused on data formats yet. We were in MVP mode, and JSON worked.","e09c82dcc8b3",{"_type":49,"style":50,"_key":198,"markDefs":199,"children":200},"d1634b2cd721",[],[201],{"_type":62,"marks":202,"text":143,"_key":203},[],"d1634b2cd7210",{"markDefs":205,"children":206,"_type":49,"style":50,"_key":211},[],[207],{"_type":62,"marks":208,"text":209,"_key":210},[],"We knew we needed a message bus because we have multiple services that process Clear Street’s financial data, which is relatively real-time: messages come in, and we immediately need to process them and trigger events off certain jobs. Kafka is the industry standard for this sort of work. With its strong community support and strong storage guarantees, guaranteed ordering within partitions, and replay capabilities, it fits right into our vision for message bus and communication between services.","5fcde5eaa2d00","5fcde5eaa2d0",{"style":50,"_key":213,"markDefs":214,"children":215,"_type":49},"392aa663da72",[],[216],{"_type":62,"marks":217,"text":143,"_key":218},[],"392aa663da720",{"_type":49,"style":50,"_key":220,"markDefs":221,"children":222},"08b6d2355a2c",[],[223],{"marks":224,"text":225,"_key":226,"_type":62},[],"Avro, as the de facto serialization format on Kafka, was our natural starting point. It looks similar to JSON, and has similar tooling. Things were good — for a while.","08b6d2355a2c0",{"children":228,"_type":49,"style":180,"_key":233,"markDefs":234},[229],{"_type":62,"marks":230,"text":231,"_key":232},[186],"High-Level Architecture","f184580828690","f18458082869",[],{"children":236,"_type":49,"style":50,"_key":241,"markDefs":242},[237],{"_type":62,"marks":238,"text":239,"_key":240},[],"The chart maps a clear stream of data from the user to us, and what we then do with that data — and why using stream processing (or a streaming framework) makes this approach so performant.","1490d2b1da870","1490d2b1da87",[],{"_type":49,"style":50,"_key":244,"markDefs":245,"children":246},"d53662da76d8",[],[247],{"_key":248,"_type":62,"marks":249,"text":143},"d53662da76d80",[],{"_key":251,"markDefs":252,"children":253,"_type":49,"style":50},"11769de88f57",[],[254],{"_type":62,"marks":255,"text":256,"_key":257},[],"The smiley face on the left denotes one of our many happy clients. They use something called an OMS, or order management system, to talk to Clear Street. The blue cloud to the right of the OMS denotes Clear Street’s operations.","11769de88f570",{"children":259,"_type":49,"style":50,"_key":263,"markDefs":264},[260],{"_type":62,"marks":261,"text":143,"_key":262},[],"bfe9821364090","bfe982136409",[],{"alt":143,"caption":266,"_type":267,"hotspot":9,"width":268,"height":269,"_key":270,"asset":271,"children":9,"extension":273,"url":274},[],"figureNews",960,540,"151441e2caed",{"_type":25,"_ref":272},"image-6469d0f8259ef3a6bbdc764f13d47976d95ba969-960x540-webp","webp","https://cdn.sanity.io/images/40fnhjbe/production/6469d0f8259ef3a6bbdc764f13d47976d95ba969-960x540.webp",{"children":276,"_type":49,"style":50,"_key":280,"markDefs":281},[277],{"_type":62,"marks":278,"text":143,"_key":279},[],"502f8c675d870","502f8c675d87",[],{"_key":283,"markDefs":284,"children":285,"_type":49,"style":50},"aa3a66408187",[],[286],{"_type":62,"marks":287,"text":288,"_key":289},[],"Three sources feed into our trade engine. Our happy finance operations team is doing internal trading, using the same tools as our customers. This X protocol processor manages anything like X format — any protocol that comes in gets processed. And, finally, people send us files, which we process. This all goes into our trade engine, which then feeds into a variety of channels: risk engine, data lake processing, our frontend, and our database.","aa3a664081870",{"style":50,"_key":291,"markDefs":292,"children":293,"_type":49},"3e4e925667b8",[],[294],{"_type":62,"marks":295,"text":143,"_key":296},[],"3e4e925667b80",{"markDefs":298,"children":299,"_type":49,"style":50,"_key":304},[],[300],{"_type":62,"marks":301,"text":302,"_key":303},[],"In 2018, this process served us and our client teams just fine.","6ce1616c7c180","6ce1616c7c18",{"style":180,"_key":306,"markDefs":307,"children":308,"_type":49},"e5441bb66763",[],[309],{"_type":62,"marks":310,"text":311,"_key":312},[186],"Times Change — Enter Protobuf and gRPC","e5441bb667630",{"_type":49,"style":50,"_key":314,"markDefs":315,"children":316},"49e8606762f1",[],[317],{"_type":62,"marks":318,"text":319,"_key":320},[],"By the next year, the number of microservices on Clear Street had grown significantly. We were transferring even more data over these APIs. The REST model that had worked so well was no longer fast enough.","49e8606762f10",{"markDefs":322,"children":323,"_type":49,"style":50,"_key":327},[],[324],{"_type":62,"marks":325,"text":143,"_key":326},[],"9aa4a2d4df1d0","9aa4a2d4df1d",{"_key":329,"markDefs":330,"children":331,"_type":49,"style":50},"ca4eaea3fd20",[],[332],{"_type":62,"marks":333,"text":334,"_key":335},[],"When in doubt, look for a working model. Protobuf/gRPC was designed by Google with the scale of their own operation in mind, and gRPC is Google RPC, or remote procedure call: their way of communicating between services. Protobuf offers:","ca4eaea3fd200",{"markDefs":337,"children":338,"level":343,"_type":49,"style":50,"_key":344,"listItem":345},[],[339],{"_type":62,"marks":340,"text":341,"_key":342},[],"Great community support and tooling (pretty much every major company on Earth uses it)","bb3c03a510a50",1,"bb3c03a510a5","bullet",{"children":347,"level":343,"_type":49,"style":50,"_key":352,"listItem":345,"markDefs":353},[348],{"_type":62,"marks":349,"text":350,"_key":351},[],"Relatively easy move from Swagger","2dd2f19448ad0","2dd2f19448ad",[],{"_type":49,"style":50,"_key":355,"listItem":345,"markDefs":356,"children":357,"level":343},"89e8ce14b1dc",[],[358],{"text":359,"_key":360,"_type":62,"marks":361},"Good codegen","89e8ce14b1dc0",[],{"listItem":345,"markDefs":363,"children":364,"level":343,"_type":49,"style":50,"_key":369},[],[365],{"_type":62,"marks":366,"text":367,"_key":368},[],"Really fast Serialization and Deserialization (SerDe) and compression","3a72b04e6b450","3a72b04e6b45",{"style":50,"_key":371,"markDefs":372,"children":373,"_type":49},"7f22ca9752af",[],[374],{"_type":62,"marks":375,"text":143,"_key":376},[],"7f22ca9752af0",{"_key":378,"markDefs":379,"children":380,"_type":49,"style":50},"ada778b6378b",[],[381],{"marks":382,"text":383,"_key":384,"_type":62},[],"However, this wasn’t a one-click solution. At first, we only moved our APIs over to Protobuf. Avro was still in full force for Kafka and events, and our devs were increasingly frustrated by the growing number of schemas.","ada778b6378b0",{"style":50,"_key":386,"markDefs":387,"children":388,"_type":49},"44ee2ff2153d",[],[389],{"text":143,"_key":390,"_type":62,"marks":391},"44ee2ff2153d0",[],{"_type":49,"style":50,"_key":393,"markDefs":394,"children":395},"eeb77e35a7c7",[],[396],{"_type":62,"marks":397,"text":398,"_key":399},[],"We had different schemas for synchronous and asynchronous events, multiple formats, and external vendors — DTCC, banks, brokers, the OCC — all on different systems. This wasn’t scalable as Clear Street kept growing.","eeb77e35a7c70",{"style":50,"_key":401,"markDefs":402,"children":403,"_type":49},"099ad1eea539",[],[404],{"_key":405,"_type":62,"marks":406,"text":143},"099ad1eea5390",[],{"width":268,"asset":408,"_type":267,"caption":410,"height":269,"extension":273,"hotspot":9,"url":411,"children":9,"alt":143,"_key":412},{"_ref":409,"_type":25},"image-476ac30abd7cf9a16cf3602e8f82a1702e0aaca9-960x540-webp",[],"https://cdn.sanity.io/images/40fnhjbe/production/476ac30abd7cf9a16cf3602e8f82a1702e0aaca9-960x540.webp","7b11f0f04523",{"markDefs":414,"children":415,"_type":49,"style":50,"_key":420},[],[416],{"_type":62,"marks":417,"text":418,"_key":419},[],"Protobuf started to become the dominant data format at Clear Street. Simultaneously, we hit issues with Avro and our change data captures (CDCs), which took data from our database and moved it onto Kafka using Debezium. On top of that, we had problems with schema migrations using Avro that could potentially lead to massive rollbacks.","e9d8d0c0e11f0","e9d8d0c0e11f",{"style":50,"_key":422,"markDefs":423,"children":424,"_type":49},"8db7174aa5ab",[],[425],{"_key":426,"_type":62,"marks":427,"text":143},"8db7174aa5ab0",[],{"markDefs":429,"children":430,"_type":49,"style":50,"_key":435},[],[431],{"text":432,"_key":433,"_type":62,"marks":434},"The devs continued to call out for greater simplicity. We listened.","9c27e47742840",[],"9c27e4774284",{"children":437,"_type":49,"style":180,"_key":442,"markDefs":443},[438],{"text":439,"_key":440,"_type":62,"marks":441},"Building an In-House Tool","d7411b4c7a270",[186],"d7411b4c7a27",[],{"children":445,"_type":49,"style":50,"_key":450,"markDefs":451},[446],{"_type":62,"marks":447,"text":448,"_key":449},[],"We realized that switching everything to Protobuf would solve our Avro problems. Avro offers built-in data modeling tools, faster performance, and runs on just one model between APIs and events. However, there were caveats when using Protobuf on Kafka:","e1723953c80a0","e1723953c80a",[],{"_key":453,"listItem":345,"markDefs":454,"children":455,"level":343,"_type":49,"style":50},"a074ae1fa3e7",[],[456],{"_type":62,"marks":457,"text":458,"_key":459},[],"Tooling was either not as good or non-existent","a074ae1fa3e70",{"_type":49,"style":50,"_key":461,"listItem":345,"markDefs":462,"children":463,"level":343},"65b213137f8b",[],[464],{"_key":465,"_type":62,"marks":466,"text":467},"65b213137f8b0",[],"We faced a large migration effort on the code side",{"markDefs":469,"children":470,"level":343,"_type":49,"style":50,"_key":475,"listItem":345},[],[471],{"marks":472,"text":473,"_key":474,"_type":62},[],"There were debates as to whether we migrate historical Avro data to Protobuf","7bdf502f909b0","7bdf502f909b",{"_type":49,"style":50,"_key":477,"markDefs":478,"children":479},"ea268f11471e",[],[480],{"_type":62,"marks":481,"text":143,"_key":482},[],"ea268f11471e0",{"_key":484,"markDefs":485,"children":486,"_type":49,"style":50},"e39484c7ff2a",[],[487],{"_type":62,"marks":488,"text":489,"_key":490},[],"Undeterred, we stuck to our gut and went with Protobuf. The first thing we did was tackle tooling. We built an in-house tool, called “fleet” CLI (named after our repo). Here it is in action:","e39484c7ff2a0",{"_type":49,"style":50,"_key":492,"markDefs":493,"children":494},"5ab7246109e5",[],[495],{"_type":62,"marks":496,"text":143,"_key":497},[],"5ab7246109e50",{"asset":499,"children":9,"_type":267,"width":268,"alt":143,"caption":501,"_key":502,"hotspot":9,"url":503,"height":269,"extension":273},{"_ref":500,"_type":25},"image-c538b98474c754a746e0d36a6d5e596c9bbf4daf-960x540-webp",[],"71dfc7b49fee","https://cdn.sanity.io/images/40fnhjbe/production/c538b98474c754a746e0d36a6d5e596c9bbf4daf-960x540.webp",{"children":505,"_type":49,"style":50,"_key":509,"markDefs":510},[506],{"_type":62,"marks":507,"text":143,"_key":508},[],"1f7c248b033e0","1f7c248b033e",[],{"_type":49,"style":50,"_key":512,"markDefs":513,"children":514},"d77ccd7ad010",[],[515],{"marks":516,"text":517,"_key":518,"_type":62},[],"In this YAML format, fleet lets us define Protobuf and its properties by generating command-based code. In the above case, we’re saying “my Proto files are located in this folder,” and use this Go plugin, and fleet generates GoLang code.","d77ccd7ad0100",{"style":50,"_key":520,"markDefs":521,"children":522,"_type":49},"cdab2e5604e3",[],[523],{"_type":62,"marks":524,"text":143,"_key":525},[],"cdab2e5604e30",{"_key":527,"asset":528,"_type":267,"hotspot":9,"width":268,"alt":143,"children":9,"url":530,"height":269,"extension":273,"caption":531},"19ef3c3d07de",{"_type":25,"_ref":529},"image-265eb2c779b26dae2c5bd126f74b6508283ea850-960x540-webp","https://cdn.sanity.io/images/40fnhjbe/production/265eb2c779b26dae2c5bd126f74b6508283ea850-960x540.webp",[],{"markDefs":533,"children":534,"_type":49,"style":50,"_key":538},[],[535],{"_type":62,"marks":536,"text":143,"_key":537},[],"a9cd6364e9b30","a9cd6364e9b3",{"markDefs":540,"children":541,"_type":49,"style":50,"_key":546},[],[542],{"_type":62,"marks":543,"text":544,"_key":545},[],"We built a a full ecosystem for using Protobuf on Kafka by:","09f2c4177f420","09f2c4177f42",{"_key":548,"listItem":345,"markDefs":549,"children":550,"level":343,"_type":49,"style":50},"0c2f45dffc87",[],[551],{"_type":62,"marks":552,"text":553,"_key":554},[],"Standardizing our message format and using schemas in our headers","0c2f45dffc870",{"style":50,"_key":556,"listItem":345,"markDefs":557,"children":558,"level":343,"_type":49},"66edd6c1be03",[],[559],{"_type":62,"marks":560,"text":561,"_key":562},[],"Increasing our debugging tools","66edd6c1be030",{"style":50,"_key":564,"listItem":345,"markDefs":565,"children":569,"level":343,"_type":49},"c2b99455a009",[566],{"_type":54,"to":567,"_key":568},"https://github.com/provectus/kafka-ui","03a7f6936576",[570,574,578],{"text":571,"_key":572,"_type":62,"marks":573},"Adding patches to a popular open source viewer, ","c2b99455a0090",[],{"_type":62,"marks":575,"text":576,"_key":577},[568],"Kafka UI","c2b99455a0091",{"_type":62,"marks":579,"text":580,"_key":581},[],", to deserialize and view Protobuf","c2b99455a0092",{"children":583,"level":343,"_type":49,"style":50,"_key":593,"listItem":345,"markDefs":594},[584,588],{"marks":585,"text":586,"_key":587,"_type":62},[],"Implementing a remote schema registry using ","d3fdf99b728c0",{"_type":62,"marks":589,"text":591,"_key":592},[590],"5c67f490d021","Buf.io","d3fdf99b728c1","d3fdf99b728c",[595],{"_type":54,"to":596,"_key":590},"https://buf.build/",{"_key":598,"markDefs":599,"children":600,"_type":49,"style":180},"1bedda886238",[],[601],{"_key":602,"_type":62,"marks":603,"text":604},"1bedda8862380",[186],"The Great Migration",{"markDefs":606,"children":607,"_type":49,"style":50,"_key":612},[],[608],{"_type":62,"marks":609,"text":610,"_key":611},[],"Migrating from Avro to Protobuf was smooth, and our libraries were patched quickly. Development inertia was supported by our new trade engine, which also uses Protobuf. We saw a huge increase in network usage performance:","9c04dce6c9300","9c04dce6c930",{"_type":49,"style":50,"_key":614,"markDefs":615,"children":616},"81f06f152359",[],[617],{"_type":62,"marks":618,"text":143,"_key":619},[],"81f06f1523590",{"caption":621,"asset":622,"height":624,"width":625,"extension":273,"hotspot":9,"_key":626,"children":9,"_type":267,"alt":143,"url":627},[],{"_ref":623,"_type":25},"image-53a80f32a85d9eb76cc14d5de03a31daf42c3f4d-1294x234-webp",234,1294,"864bee714455","https://cdn.sanity.io/images/40fnhjbe/production/53a80f32a85d9eb76cc14d5de03a31daf42c3f4d-1294x234.webp",{"_type":49,"style":50,"_key":629,"markDefs":630,"children":631},"7d2aed9fc3ee",[],[632],{"_type":62,"marks":633,"text":143,"_key":634},[],"7d2aed9fc3ee0",{"_key":636,"markDefs":637,"children":638,"_type":49,"style":50},"3707863769ac",[],[639],{"_type":62,"marks":640,"text":641,"_key":642},[],"By transferring more compressed information, we improved our usage from an average of 32–64 kilobytes per second to only 10 or 12. Almost half of the data is being transferred, but we’re transferring the same amount of information, just more compressed. The overlap in early April was when we were running both systems at the same time.","3707863769ac0",{"children":644,"_type":49,"style":50,"_key":648,"markDefs":649},[645],{"marks":646,"text":143,"_key":647,"_type":62},[],"8c844062f75b0","8c844062f75b",[],{"caption":651,"_key":652,"hotspot":9,"width":268,"extension":273,"children":9,"_type":267,"alt":143,"asset":653,"url":655,"height":269},[],"dcde02dc9b0c",{"_ref":654,"_type":25},"image-8b9cedabbc0ddb684e6ca893a8d28c3b79fb45a8-960x540-webp","https://cdn.sanity.io/images/40fnhjbe/production/8b9cedabbc0ddb684e6ca893a8d28c3b79fb45a8-960x540.webp",{"markDefs":657,"children":658,"_type":49,"style":50,"_key":663},[],[659],{"_key":660,"_type":62,"marks":661,"text":662},"af63f42db9c10",[],"The highlighted area shows how much time we used to spend on deserialization — it’s almost entirely gone now. We removed a full 20% of the work from the services themselves.\n","af63f42db9c1",{"style":180,"_key":665,"markDefs":666,"children":667,"_type":49},"5592cebca9ed",[],[668],{"_type":62,"marks":669,"text":670,"_key":671},[186],"This Was an Experiment — at First","5592cebca9ed0",{"children":673,"_type":49,"style":50,"_key":678,"markDefs":679},[674],{"text":675,"_key":676,"_type":62,"marks":677},"Going in, we knew that Kafka would work well with Protobuf, but we wondered whether the rest of the system would be happy. Our main concern was whether the tooling was enough to support developers, 100 engineers, and fast enough when it’s 3:00 AM and something’s broken?","36b28c24d12e0",[],"36b28c24d12e",[],{"markDefs":681,"children":682,"_type":49,"style":50,"_key":686},[],[683],{"_key":684,"_type":62,"marks":685,"text":143},"876bbc5620bc0",[],"876bbc5620bc",{"style":50,"_key":688,"markDefs":689,"children":690,"_type":49},"b2df6955c8f1",[],[691],{"_key":692,"_type":62,"marks":693,"text":694},"b2df6955c8f10",[],"Our inflection point was developer struggle. Our developers were dealing with eight or nine formats every day and writing hundreds of lines of code just to convert from one format to another. If we didn’t standardize, we’d spent 40% to 50% of the code on converters alone.",{"children":696,"_type":49,"style":50,"_key":700,"markDefs":701},[697],{"_type":62,"marks":698,"text":143,"_key":699},[],"4c123ed9dbc90","4c123ed9dbc9",[],{"style":50,"_key":703,"markDefs":704,"children":708,"_type":49},"df5c5e996eb6",[705],{"_key":706,"_type":54,"to":707},"b351cd3e3726","https://github.com/clear-street/kafka-ui",[709,713,717],{"_type":62,"marks":710,"text":711,"_key":712},[],"Much of what we’re developing is open source. For example, all the changes we made to KafkaUI are on ","df5c5e996eb60",{"marks":714,"text":715,"_key":716,"_type":62},[706],"Clear Street’s GitHub","df5c5e996eb61",{"text":718,"_key":719,"_type":62,"marks":720},". We are in the process of making a push request back to the original authors explaining how we’d added Protobuf support to KafkaUI.","df5c5e996eb62",[],{"_key":722,"markDefs":723,"children":724,"_type":49,"style":180},"ae2d9e4c434b",[],[725],{"marks":726,"text":727,"_key":728,"_type":62},[186],"Next Steps","ae2d9e4c434b0",{"_key":730,"markDefs":731,"children":732,"_type":49,"style":50},"a51411fbf19a",[],[733],{"_type":62,"marks":734,"text":735,"_key":736},[],"Our mission is to build a modern, API-based system to replace the legacy infrastructure used across the capital markets. Clear Street’s growth depends on our ability to build products fast, and iterate and innovate on small pieces. We’re now in a much better position to continue rapidly scaling our business with a much more solid foundation.","a51411fbf19a0",{"markDefs":738,"children":739,"_type":49,"style":50,"_key":743},[],[740],{"_type":62,"marks":741,"text":143,"_key":742},[],"bde4f86308830","bde4f8630883",{"_key":745,"markDefs":746,"children":747,"_type":49,"style":50},"1ee74e49ed5f",[],[748],{"_type":62,"marks":749,"text":750,"_key":751},[],"We’re building out and refining our client-facing position, risk, operations, and reporting portals. As our platform and client base grow, and our asset class diversity does so along with them, we look forward to strengthening and retooling our technology to meet our clients’ evolving needs.","1ee74e49ed5f0",[],[754,762],{"_type":49,"style":50,"_key":755,"markDefs":756,"children":757},"01d9743bd6e6",[],[758],{"_type":62,"marks":759,"text":760,"_key":761},[186],"About Clear Street:","820e76cb468a0",{"markDefs":763,"children":767,"_type":49,"style":50,"_key":779},[764],{"_key":765,"_type":54,"href":766},"f69e401d33e9","https://clearstreet.io",[768,772,775],{"_type":62,"marks":769,"text":770,"_key":771},[],"Clear Street is modernizing the brokerage ecosystem with financial technology and services that empower market participants with real-time data and best-in-class products, tools and teams, to navigate capital markets around the world. Complemented by white-glove service, Clear Street's cloud-native, proprietary product suite delivers financing, derivatives, execution and more to power client success, adding efficiency to the market and enabling clients to minimize risk, redundancy and cost. Clear Street’s goal is to create a single platform for every asset class, in every country and in any currency. For more information, visit ","46cc6bc340df0",{"_type":62,"marks":773,"text":766,"_key":774},[765],"46cc6bc340df1",{"_type":62,"marks":776,"text":777,"_key":778},[],".","46cc6bc340df2","6558fb161935",{"address":781,"disclaimer":782,"footerItems":809,"legalItems":841,"legalText":9,"socialNetworks":851},"4 World Trade Center\n150 Greenwich St Floor 45\nNew York, NY 10007\n(646) 845-0036",[783,793],{"style":50,"_key":784,"markDefs":785,"children":788,"_type":49},"b41b74ae73bb",[786],{"_type":54,"href":55,"_key":787},"d38625939708",[789],{"_key":790,"_type":62,"marks":791,"text":792},"331699fdb6140",[],"Products and services are offered by Clear Street LLC as a Broker Dealer member FINRA and SIPC and a Futures Commission Merchant registered with the CFTC and member of NFA. ",{"_type":49,"style":50,"_key":794,"markDefs":795,"children":797},"dbec5081eda7",[796],{"_type":54,"href":55,"_key":787},[798,802,805],{"text":799,"_key":800,"_type":62,"marks":801},"Additional information about Clear Street is available on FINRA ","42e587e4d749",[],{"text":68,"_key":803,"_type":62,"marks":804},"4894062c01ca",[787],{"text":806,"_key":807,"_type":62,"marks":808},", including its Customer Relationship Summary and NFA BASIC | NFA (futures.org).","6db9006e1b4a",[],[810,823,835],{"title":113,"pages":811},[812,816,819,822],{"type":813,"title":814,"slug":815},"internal","About","about",{"type":813,"title":817,"slug":818},"News & Content","news",{"type":813,"title":820,"slug":821},"Careers","careers",{"type":813,"title":91,"slug":92},{"title":824,"pages":825},"Services",[826,829,832],{"type":813,"title":827,"slug":828},"Institutional","institutional",{"type":813,"title":830,"slug":831},"Professional Clearing","professional-clearing",{"type":813,"title":833,"slug":834},"Active Trader","active-trader",{"title":836,"pages":837},"Products",[838],{"type":813,"title":839,"slug":840},"Studio","studio",[842,845,848],{"title":843,"slug":844},"Regulatory Disclosures","regulatory-disclosures",{"title":846,"slug":847},"Privacy Policy","privacy-policy",{"title":849,"slug":850},"Security","security",[852,857,861,865],{"_type":853,"link":854,"socialNetwork":855,"_key":856},"links","https://github.com/clear-street","github","466192507eea",{"_type":853,"link":858,"socialNetwork":859,"_key":860},"https://www.linkedin.com/company/clear-street","linkedin","43f9fa8f49d0",{"_type":853,"link":862,"socialNetwork":863,"_key":864},"https://www.youtube.com/@ClearStreetNYC","youtube","b581a744d770",{"socialNetwork":866,"_key":867,"_type":853,"link":868},"spotify","7625c0ffc2b2","https://open.spotify.com/show/3Bbl6x17ZSdnijTTDq6tKi",1733511759089]